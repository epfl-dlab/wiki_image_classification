{'epochs': 30, 'augment': False, 'basemodel': 'EfficientNetB2', 'nr_classes': 20, 'batch_size': 512, 'undersample': False, 'data_folder': 'data/split_dataframes_heuristic_labels_20221006', 'loss_function': 'binary_crossentropy', 'class_weights': False, 'image_dimension': 64, 'random_initialization': False, 'number_trainable_layers': 339, 'results_folder': 'thesis_experiments/0_imagenet_weights'}
Time passed: 0.0 hours
15:04:38
Found 760000 non-validated image filenames belonging to 42 classes.
Found 752497 validated image filenames belonging to 20 classes.
LOG: finished getting the first flow
Time passed: 0.15 hours
15:13:38
Found 50000 non-validated image filenames belonging to 40 classes.
Found 49514 validated image filenames belonging to 20 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
15:13:41
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 20)                2580      
=================================================================
Total params: 8,492,173
Trainable params: 8,424,598
Non-trainable params: 67,575
_________________________________________________________________
Epoch 1/30

Epoch 00001: val_loss improved from inf to 0.23352, saving model to thesis_experiments/0_imagenet_weights/cp-0001.ckpt
23516/23516 - 13551s - loss: 0.2353 - accuracy: 0.2638 - categorical_accuracy: 0.2638 - val_loss: 0.2335 - val_accuracy: 0.2854 - val_categorical_accuracy: 0.2854
Epoch 2/30

Epoch 00002: val_loss did not improve from 0.23352
23516/23516 - 8109s - loss: 0.2277 - accuracy: 0.2794 - categorical_accuracy: 0.2794 - val_loss: 0.2382 - val_accuracy: 0.2904 - val_categorical_accuracy: 0.2904
Epoch 3/30

Epoch 00003: val_loss did not improve from 0.23352
23516/23516 - 2822s - loss: 0.2247 - accuracy: 0.2863 - categorical_accuracy: 0.2863 - val_loss: 0.2791 - val_accuracy: 0.2883 - val_categorical_accuracy: 0.2883
Epoch 4/30

Epoch 00004: val_loss did not improve from 0.23352
23516/23516 - 1886s - loss: 0.2250 - accuracy: 0.2859 - categorical_accuracy: 0.2859 - val_loss: 0.4843 - val_accuracy: 0.2963 - val_categorical_accuracy: 0.2963
Epoch 5/30

Epoch 00005: val_loss improved from 0.23352 to 0.22862, saving model to thesis_experiments/0_imagenet_weights/cp-0005.ckpt
23516/23516 - 1729s - loss: 0.2222 - accuracy: 0.2926 - categorical_accuracy: 0.2926 - val_loss: 0.2286 - val_accuracy: 0.3006 - val_categorical_accuracy: 0.3006
Epoch 6/30

Epoch 00006: val_loss did not improve from 0.22862
23516/23516 - 1798s - loss: 0.2198 - accuracy: 0.2984 - categorical_accuracy: 0.2984 - val_loss: 0.2425 - val_accuracy: 0.2938 - val_categorical_accuracy: 0.2938
Epoch 7/30

Epoch 00007: val_loss did not improve from 0.22862
23516/23516 - 1700s - loss: 0.2181 - accuracy: 0.3022 - categorical_accuracy: 0.3022 - val_loss: 0.2481 - val_accuracy: 0.3048 - val_categorical_accuracy: 0.3048
Epoch 8/30

Epoch 00008: val_loss did not improve from 0.22862
23516/23516 - 1700s - loss: 0.2166 - accuracy: 0.3052 - categorical_accuracy: 0.3052 - val_loss: 0.2363 - val_accuracy: 0.3069 - val_categorical_accuracy: 0.3069
Epoch 9/30

Epoch 00009: val_loss did not improve from 0.22862
23516/23516 - 1701s - loss: 0.2152 - accuracy: 0.3085 - categorical_accuracy: 0.3085 - val_loss: 0.2397 - val_accuracy: 0.2975 - val_categorical_accuracy: 0.2975
Epoch 10/30

Epoch 00010: val_loss did not improve from 0.22862
23516/23516 - 1747s - loss: 0.2140 - accuracy: 0.3106 - categorical_accuracy: 0.3106 - val_loss: 0.2517 - val_accuracy: 0.3093 - val_categorical_accuracy: 0.3093
Epoch 11/30

Epoch 00011: val_loss did not improve from 0.22862
23516/23516 - 1778s - loss: 0.2129 - accuracy: 0.3131 - categorical_accuracy: 0.3131 - val_loss: 0.2370 - val_accuracy: 0.3080 - val_categorical_accuracy: 0.3080
Epoch 12/30

Epoch 00012: val_loss did not improve from 0.22862
23516/23516 - 1832s - loss: 0.2117 - accuracy: 0.3154 - categorical_accuracy: 0.3154 - val_loss: 0.2335 - val_accuracy: 0.3023 - val_categorical_accuracy: 0.3023
Epoch 13/30

Epoch 00013: val_loss improved from 0.22862 to 0.22834, saving model to thesis_experiments/0_imagenet_weights/cp-0013.ckpt
23516/23516 - 1895s - loss: 0.2107 - accuracy: 0.3176 - categorical_accuracy: 0.3176 - val_loss: 0.2283 - val_accuracy: 0.3074 - val_categorical_accuracy: 0.3074
Epoch 14/30

Epoch 00014: val_loss did not improve from 0.22834
23516/23516 - 1816s - loss: 0.2097 - accuracy: 0.3199 - categorical_accuracy: 0.3199 - val_loss: 0.2346 - val_accuracy: 0.3050 - val_categorical_accuracy: 0.3050
Epoch 15/30

Epoch 00015: val_loss did not improve from 0.22834
23516/23516 - 1826s - loss: 0.2087 - accuracy: 0.3221 - categorical_accuracy: 0.3221 - val_loss: 0.2309 - val_accuracy: 0.3020 - val_categorical_accuracy: 0.3020
Epoch 16/30

Epoch 00016: val_loss did not improve from 0.22834
23516/23516 - 1823s - loss: 0.2078 - accuracy: 0.3236 - categorical_accuracy: 0.3236 - val_loss: 0.2377 - val_accuracy: 0.3043 - val_categorical_accuracy: 0.3043
Epoch 17/30

Epoch 00017: val_loss did not improve from 0.22834
23516/23516 - 1782s - loss: 0.2069 - accuracy: 0.3266 - categorical_accuracy: 0.3266 - val_loss: 0.2350 - val_accuracy: 0.3064 - val_categorical_accuracy: 0.3064
Epoch 18/30

Epoch 00018: val_loss did not improve from 0.22834
23516/23516 - 1792s - loss: 0.2059 - accuracy: 0.3287 - categorical_accuracy: 0.3287 - val_loss: 0.2293 - val_accuracy: 0.3074 - val_categorical_accuracy: 0.3074
Epoch 19/30

Epoch 00019: val_loss did not improve from 0.22834
23516/23516 - 1770s - loss: 0.2050 - accuracy: 0.3305 - categorical_accuracy: 0.3305 - val_loss: 0.2302 - val_accuracy: 0.3126 - val_categorical_accuracy: 0.3126
Epoch 20/30

Epoch 00020: val_loss did not improve from 0.22834
23516/23516 - 1799s - loss: 0.2041 - accuracy: 0.3325 - categorical_accuracy: 0.3325 - val_loss: 0.2320 - val_accuracy: 0.3089 - val_categorical_accuracy: 0.3089
Epoch 21/30

Epoch 00021: val_loss did not improve from 0.22834
23516/23516 - 1776s - loss: 0.2032 - accuracy: 0.3341 - categorical_accuracy: 0.3341 - val_loss: 0.2324 - val_accuracy: 0.3056 - val_categorical_accuracy: 0.3056
Epoch 22/30

Epoch 00022: val_loss did not improve from 0.22834
23516/23516 - 1759s - loss: 0.2023 - accuracy: 0.3357 - categorical_accuracy: 0.3357 - val_loss: 0.2357 - val_accuracy: 0.3025 - val_categorical_accuracy: 0.3025
Epoch 23/30

Epoch 00023: val_loss did not improve from 0.22834
23516/23516 - 1785s - loss: 0.2014 - accuracy: 0.3383 - categorical_accuracy: 0.3383 - val_loss: 0.2348 - val_accuracy: 0.3132 - val_categorical_accuracy: 0.3132
Epoch 24/30

Epoch 00024: val_loss did not improve from 0.22834
23516/23516 - 1784s - loss: 0.2006 - accuracy: 0.3399 - categorical_accuracy: 0.3399 - val_loss: 0.2346 - val_accuracy: 0.3050 - val_categorical_accuracy: 0.3050
Epoch 25/30

Epoch 00025: val_loss did not improve from 0.22834
23516/23516 - 1813s - loss: 0.1997 - accuracy: 0.3419 - categorical_accuracy: 0.3419 - val_loss: 0.2380 - val_accuracy: 0.3037 - val_categorical_accuracy: 0.3037
Epoch 26/30

Epoch 00026: val_loss did not improve from 0.22834
23516/23516 - 1815s - loss: 0.1989 - accuracy: 0.3441 - categorical_accuracy: 0.3441 - val_loss: 0.2412 - val_accuracy: 0.3085 - val_categorical_accuracy: 0.3085
Epoch 27/30

Epoch 00027: val_loss did not improve from 0.22834
23516/23516 - 2765s - loss: 0.1982 - accuracy: 0.3454 - categorical_accuracy: 0.3454 - val_loss: 0.2328 - val_accuracy: 0.2995 - val_categorical_accuracy: 0.2995
Epoch 28/30

Epoch 00028: val_loss did not improve from 0.22834
23516/23516 - 3928s - loss: 0.1974 - accuracy: 0.3472 - categorical_accuracy: 0.3472 - val_loss: 0.2457 - val_accuracy: 0.3012 - val_categorical_accuracy: 0.3012
Time passed: 20.09 hours
11:18:49
