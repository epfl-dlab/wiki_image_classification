Found 50000 non-validated image filenames belonging to 40 classes.
Found 49514 validated image filenames belonging to 20 classes.

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 20)                2580      
=================================================================
Total params: 8,492,173
Trainable params: 8,424,598
Non-trainable params: 67,575
_________________________________________________________________
thesis_experiments/0_imagenet_weights/checkpoints/cp-0013.ckpt
Predicting on test set:

1548/1548 - 158s
Found 50000 non-validated image filenames belonging to 40 classes.
Found 49514 validated image filenames belonging to 20 classes.
Predicting on validation set:

1548/1548 - 93s
METRICS FOR THRESHOLD 0.5

Mean number of label assignments per image in ground-truth: 2.1286
Mean number of label assignments per image in predictions: 1.1555

               precision    recall  f1-score   support index
Architecture    0.000000  0.000000  0.000000     814.0     0
Art             0.607407  0.054703  0.100367    1499.0     1
Biology         0.626050  0.350588  0.449472     425.0     2
Culture         0.564284  0.242658  0.339375   12462.0     3
Entertainment   0.558824  0.110465  0.184466    1892.0     4
Events          0.478261  0.075862  0.130952    3045.0     5
History         0.544849  0.121960  0.199306    8716.0     6
Landscapes      0.000000  0.000000  0.000000     326.0     7
Language        0.875000  0.013084  0.025783    1070.0     8
Music           0.492063  0.072261  0.126016     429.0     9
Nature          0.651903  0.381816  0.481576    7941.0    10
Objects         0.616187  0.164459  0.259624   10416.0    11
People          0.631435  0.529109  0.575761   10478.0    12
Places          0.697506  0.638375  0.666632   19935.0    13
Plants          0.525517  0.545064  0.535112     699.0    14
Politics        0.513514  0.097899  0.164447    2523.0    15
Science         0.000000  0.000000  0.000000     450.0    16
Society         0.558990  0.348659  0.429455   17530.0    17
Sports          0.598485  0.444396  0.510057    2311.0    18
Technology      0.616197  0.071928  0.128819    2433.0    19
micro avg       0.625011  0.339298  0.439828  105394.0  None
macro avg       0.507824  0.213164  0.265361  105394.0  None
weighted avg    0.598505  0.339298  0.406070  105394.0  None
samples avg     0.530744  0.396212  0.420883  105394.0  None

Unweighted avg. F1-score of all classes: 0.26536100929227
Unweighted avg. F1-score of top 5 classes: 0.45751238824262225
Unweighted avg. F1-score of the rest: 0.20131054964215256

METRICS WHEN HAVING PER-CLASS THRESHOLDS

Mean number of label assignments per image in ground-truth: 2.1286
Mean number of label assignments per image in predictions: 3.4792

               precision    recall  f1-score   support index
Architecture    0.111373  0.174447  0.135950     814.0     0
Art             0.252652  0.349566  0.293311    1499.0     1
Biology         0.698020  0.331765  0.449761     425.0     2
Culture         0.364349  0.716097  0.482966   12462.0     3
Entertainment   0.238339  0.245772  0.241998    1892.0     4
Events          0.254108  0.472250  0.330423    3045.0     5
History         0.311440  0.608765  0.412068    8716.0     6
Landscapes      0.069200  0.374233  0.116802     326.0     7
Language        0.070534  0.568224  0.125490    1070.0     8
Music           0.258929  0.202797  0.227451     429.0     9
Nature          0.529828  0.499937  0.514449    7941.0    10
Objects         0.359225  0.688652  0.472156   10416.0    11
People          0.547015  0.745085  0.630869   10478.0    12
Places          0.631030  0.798545  0.704973   19935.0    13
Plants          0.474320  0.673820  0.556738     699.0    14
Politics        0.278430  0.385256  0.323246    2523.0    15
Science         0.093750  0.053333  0.067989     450.0    16
Society         0.438357  0.809698  0.568784   17530.0    17
Sports          0.541145  0.523583  0.532219    2311.0    18
Technology      0.288802  0.302096  0.295299    2433.0    19
micro avg       0.407683  0.666376  0.505876  105394.0  None
macro avg       0.340542  0.476196  0.374147  105394.0  None
weighted avg    0.440528  0.666376  0.520972  105394.0  None
samples avg     0.452748  0.705445  0.507111  105394.0  None

Unweighted avg. F1-score of all classes: 0.37414710001036533
Unweighted avg. F1-score of top 5 classes: 0.4922726587889195
Unweighted avg. F1-score of the rest: 0.33477191375084725

