Found 700000 validated image filenames belonging to 28 classes.
LOG: finished getting training flow
Found 75000 validated image filenames belonging to 28 classes.
LOG: Got the validation flow
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 4, 4, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 22528)             0         
_________________________________________________________________
dense (Dense)                (None, 128)               2883712   
_________________________________________________________________
dense_1 (Dense)              (None, 28)                3612      
=================================================================
Total params: 10,655,893
Trainable params: 10,588,318
Non-trainable params: 67,575
_________________________________________________________________
Epoch 1/30

Epoch 00001: val_pr_auc improved from -inf to 0.38843, saving model to results_paper/230414_flatModel_binary_crossentropy_monitorpr_auc/cp-0001.ckpt
5469/5469 - 3924s - loss: 0.1783 - binary_accuracy: 0.9270 - precision: 0.7108 - recall: 0.4946 - pr_auc: 0.3512 - val_loss: 0.1733 - val_binary_accuracy: 0.9291 - val_precision: 0.7185 - val_recall: 0.5138 - val_pr_auc: 0.3884
Epoch 2/30

Epoch 00002: val_pr_auc improved from 0.38843 to 0.40557, saving model to results_paper/230414_flatModel_binary_crossentropy_monitorpr_auc/cp-0002.ckpt
5469/5469 - 3701s - loss: 0.1713 - binary_accuracy: 0.9297 - precision: 0.7252 - recall: 0.5143 - pr_auc: 0.3928 - val_loss: 0.1721 - val_binary_accuracy: 0.9294 - val_precision: 0.7025 - val_recall: 0.5470 - val_pr_auc: 0.4056
Epoch 3/30

Epoch 00003: val_pr_auc improved from 0.40557 to 0.41601, saving model to results_paper/230414_flatModel_binary_crossentropy_monitorpr_auc/cp-0003.ckpt
5469/5469 - 3717s - loss: 0.1680 - binary_accuracy: 0.9310 - precision: 0.7303 - recall: 0.5267 - pr_auc: 0.4135 - val_loss: 0.1702 - val_binary_accuracy: 0.9302 - val_precision: 0.7286 - val_recall: 0.5159 - val_pr_auc: 0.4160
Epoch 4/30

Epoch 00004: val_pr_auc improved from 0.41601 to 0.42875, saving model to results_paper/230414_flatModel_binary_crossentropy_monitorpr_auc/cp-0004.ckpt
5469/5469 - 3740s - loss: 0.1653 - binary_accuracy: 0.9320 - precision: 0.7341 - recall: 0.5365 - pr_auc: 0.4309 - val_loss: 0.1712 - val_binary_accuracy: 0.9310 - val_precision: 0.7252 - val_recall: 0.5340 - val_pr_auc: 0.4287
Epoch 5/30

Epoch 00005: val_pr_auc did not improve from 0.42875
5469/5469 - 3700s - loss: 0.1628 - binary_accuracy: 0.9330 - precision: 0.7381 - recall: 0.5455 - pr_auc: 0.4470 - val_loss: 0.1707 - val_binary_accuracy: 0.9307 - val_precision: 0.7098 - val_recall: 0.5548 - val_pr_auc: 0.4278
Epoch 6/30

Epoch 00006: val_pr_auc did not improve from 0.42875
5469/5469 - 3733s - loss: 0.1605 - binary_accuracy: 0.9340 - precision: 0.7411 - recall: 0.5546 - pr_auc: 0.4605 - val_loss: 0.1745 - val_binary_accuracy: 0.9305 - val_precision: 0.7099 - val_recall: 0.5515 - val_pr_auc: 0.4225
Epoch 7/30

Epoch 00007: val_pr_auc did not improve from 0.42875
5469/5469 - 3769s - loss: 0.1583 - binary_accuracy: 0.9348 - precision: 0.7445 - recall: 0.5622 - pr_auc: 0.4732 - val_loss: 0.1717 - val_binary_accuracy: 0.9311 - val_precision: 0.7161 - val_recall: 0.5508 - val_pr_auc: 0.4229
Epoch 8/30

Epoch 00008: val_pr_auc did not improve from 0.42875
5469/5469 - 3818s - loss: 0.1562 - binary_accuracy: 0.9357 - precision: 0.7478 - recall: 0.5703 - pr_auc: 0.4857 - val_loss: 0.1704 - val_binary_accuracy: 0.9308 - val_precision: 0.7192 - val_recall: 0.5397 - val_pr_auc: 0.4271
Epoch 9/30

Epoch 00009: val_pr_auc improved from 0.42875 to 0.43011, saving model to results_paper/230414_flatModel_binary_crossentropy_monitorpr_auc/cp-0009.ckpt
5469/5469 - 3707s - loss: 0.1539 - binary_accuracy: 0.9366 - precision: 0.7511 - recall: 0.5783 - pr_auc: 0.4962 - val_loss: 0.1710 - val_binary_accuracy: 0.9309 - val_precision: 0.7239 - val_recall: 0.5334 - val_pr_auc: 0.4301
Epoch 10/30

Epoch 00010: val_pr_auc did not improve from 0.43011
5469/5469 - 3704s - loss: 0.1518 - binary_accuracy: 0.9375 - precision: 0.7542 - recall: 0.5865 - pr_auc: 0.5089 - val_loss: 0.1728 - val_binary_accuracy: 0.9304 - val_precision: 0.7116 - val_recall: 0.5468 - val_pr_auc: 0.4280
Epoch 11/30

Epoch 00011: val_pr_auc improved from 0.43011 to 0.43076, saving model to results_paper/230414_flatModel_binary_crossentropy_monitorpr_auc/cp-0011.ckpt
5469/5469 - 3677s - loss: 0.1492 - binary_accuracy: 0.9386 - precision: 0.7578 - recall: 0.5955 - pr_auc: 0.5204 - val_loss: 0.1727 - val_binary_accuracy: 0.9303 - val_precision: 0.7074 - val_recall: 0.5535 - val_pr_auc: 0.4308
Epoch 12/30

Epoch 00012: val_pr_auc did not improve from 0.43076
5469/5469 - 3696s - loss: 0.1469 - binary_accuracy: 0.9395 - precision: 0.7615 - recall: 0.6035 - pr_auc: 0.5291 - val_loss: 0.1755 - val_binary_accuracy: 0.9298 - val_precision: 0.7036 - val_recall: 0.5518 - val_pr_auc: 0.4229
Epoch 13/30

Epoch 00013: val_pr_auc did not improve from 0.43076
5469/5469 - 3675s - loss: 0.1443 - binary_accuracy: 0.9405 - precision: 0.7650 - recall: 0.6126 - pr_auc: 0.5419 - val_loss: 0.1760 - val_binary_accuracy: 0.9291 - val_precision: 0.6941 - val_recall: 0.5596 - val_pr_auc: 0.4237
Epoch 14/30

Epoch 00014: val_pr_auc did not improve from 0.43076
5469/5469 - 3689s - loss: 0.1415 - binary_accuracy: 0.9417 - precision: 0.7692 - recall: 0.6227 - pr_auc: 0.5539 - val_loss: 0.1800 - val_binary_accuracy: 0.9290 - val_precision: 0.6947 - val_recall: 0.5566 - val_pr_auc: 0.4201
Epoch 15/30

Epoch 00015: val_pr_auc did not improve from 0.43076
5469/5469 - 3700s - loss: 0.1387 - binary_accuracy: 0.9429 - precision: 0.7741 - recall: 0.6316 - pr_auc: 0.5647 - val_loss: 0.1807 - val_binary_accuracy: 0.9280 - val_precision: 0.6842 - val_recall: 0.5619 - val_pr_auc: 0.4197
Epoch 16/30

Epoch 00016: val_pr_auc did not improve from 0.43076
5469/5469 - 3686s - loss: 0.1361 - binary_accuracy: 0.9440 - precision: 0.7780 - recall: 0.6405 - pr_auc: 0.5745 - val_loss: 0.1845 - val_binary_accuracy: 0.9285 - val_precision: 0.6872 - val_recall: 0.5630 - val_pr_auc: 0.4157
Epoch 17/30

Epoch 00017: val_pr_auc did not improve from 0.43076
5469/5469 - 3904s - loss: 0.1333 - binary_accuracy: 0.9451 - precision: 0.7819 - recall: 0.6497 - pr_auc: 0.5844 - val_loss: 0.1879 - val_binary_accuracy: 0.9270 - val_precision: 0.6792 - val_recall: 0.5546 - val_pr_auc: 0.4143
Epoch 18/30

Epoch 00018: val_pr_auc did not improve from 0.43076
5469/5469 - 3699s - loss: 0.1301 - binary_accuracy: 0.9464 - precision: 0.7869 - recall: 0.6602 - pr_auc: 0.5965 - val_loss: 0.1903 - val_binary_accuracy: 0.9266 - val_precision: 0.6727 - val_recall: 0.5614 - val_pr_auc: 0.4073
Epoch 19/30

Epoch 00019: val_pr_auc did not improve from 0.43076
5469/5469 - 3683s - loss: 0.1271 - binary_accuracy: 0.9477 - precision: 0.7925 - recall: 0.6695 - pr_auc: 0.6070 - val_loss: 0.1927 - val_binary_accuracy: 0.9270 - val_precision: 0.6871 - val_recall: 0.5379 - val_pr_auc: 0.4098
Epoch 20/30

Epoch 00020: val_pr_auc did not improve from 0.43076
5469/5469 - 3670s - loss: 0.1243 - binary_accuracy: 0.9489 - precision: 0.7969 - recall: 0.6786 - pr_auc: 0.6177 - val_loss: 0.1974 - val_binary_accuracy: 0.9268 - val_precision: 0.6841 - val_recall: 0.5399 - val_pr_auc: 0.4032
Epoch 21/30

Epoch 00021: val_pr_auc did not improve from 0.43076
5469/5469 - 3660s - loss: 0.1216 - binary_accuracy: 0.9500 - precision: 0.8010 - recall: 0.6872 - pr_auc: 0.6262 - val_loss: 0.1995 - val_binary_accuracy: 0.9269 - val_precision: 0.6846 - val_recall: 0.5412 - val_pr_auc: 0.4021
Epoch 22/30

Epoch 00022: val_pr_auc did not improve from 0.43076
5469/5469 - 3689s - loss: 0.1191 - binary_accuracy: 0.9511 - precision: 0.8049 - recall: 0.6948 - pr_auc: 0.6347 - val_loss: 0.2052 - val_binary_accuracy: 0.9253 - val_precision: 0.6669 - val_recall: 0.5520 - val_pr_auc: 0.3988
Epoch 23/30

Epoch 00023: val_pr_auc did not improve from 0.43076
5469/5469 - 3686s - loss: 0.1166 - binary_accuracy: 0.9522 - precision: 0.8094 - recall: 0.7023 - pr_auc: 0.6423 - val_loss: 0.2021 - val_binary_accuracy: 0.9248 - val_precision: 0.6569 - val_recall: 0.5681 - val_pr_auc: 0.3981
Epoch 24/30

Epoch 00024: val_pr_auc did not improve from 0.43076
5469/5469 - 3644s - loss: 0.1142 - binary_accuracy: 0.9532 - precision: 0.8134 - recall: 0.7095 - pr_auc: 0.6506 - val_loss: 0.2094 - val_binary_accuracy: 0.9250 - val_precision: 0.6623 - val_recall: 0.5573 - val_pr_auc: 0.3918
Epoch 25/30

Epoch 00025: val_pr_auc did not improve from 0.43076
5469/5469 - 3657s - loss: 0.1121 - binary_accuracy: 0.9541 - precision: 0.8171 - recall: 0.7161 - pr_auc: 0.6567 - val_loss: 0.2105 - val_binary_accuracy: 0.9243 - val_precision: 0.6538 - val_recall: 0.5652 - val_pr_auc: 0.3919
Epoch 26/30

Epoch 00026: val_pr_auc did not improve from 0.43076
5469/5469 - 3651s - loss: 0.1097 - binary_accuracy: 0.9551 - precision: 0.8212 - recall: 0.7228 - pr_auc: 0.6650 - val_loss: 0.2172 - val_binary_accuracy: 0.9241 - val_precision: 0.6561 - val_recall: 0.5561 - val_pr_auc: 0.3873
Epoch 27/30

Epoch 00027: val_pr_auc did not improve from 0.43076
5469/5469 - 3656s - loss: 0.1077 - binary_accuracy: 0.9559 - precision: 0.8245 - recall: 0.7286 - pr_auc: 0.6711 - val_loss: 0.2162 - val_binary_accuracy: 0.9240 - val_precision: 0.6572 - val_recall: 0.5509 - val_pr_auc: 0.3903
Epoch 28/30

Epoch 00028: val_pr_auc did not improve from 0.43076
5469/5469 - 3644s - loss: 0.1057 - binary_accuracy: 0.9568 - precision: 0.8279 - recall: 0.7344 - pr_auc: 0.6772 - val_loss: 0.2175 - val_binary_accuracy: 0.9242 - val_precision: 0.6583 - val_recall: 0.5525 - val_pr_auc: 0.3919
Epoch 29/30

Epoch 00029: val_pr_auc did not improve from 0.43076
5469/5469 - 3643s - loss: 0.1036 - binary_accuracy: 0.9577 - precision: 0.8316 - recall: 0.7406 - pr_auc: 0.6846 - val_loss: 0.2235 - val_binary_accuracy: 0.9238 - val_precision: 0.6512 - val_recall: 0.5639 - val_pr_auc: 0.3869
Epoch 30/30

Epoch 00030: val_pr_auc did not improve from 0.43076
5469/5469 - 3654s - loss: 0.1018 - binary_accuracy: 0.9585 - precision: 0.8344 - recall: 0.7460 - pr_auc: 0.6905 - val_loss: 0.2265 - val_binary_accuracy: 0.9233 - val_precision: 0.6538 - val_recall: 0.5460 - val_pr_auc: 0.3862
Time passed: 30.9 hours
07:10:24
