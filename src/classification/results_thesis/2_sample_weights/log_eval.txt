


=============== EVALUATION ====================

Found 390000 validated image filenames belonging to 31 classes.

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
results_thesis/113_bs_512/cp-0010.ckpt
Predicting on test set:

762/762 - 7476s
METRICS FOR THRESHOLD 0.5

Mean number of label assignments per image in ground-truth: 2.3442
Mean number of label assignments per image in predictions: 1.5362

                          precision    recall  f1-score   support index
Animals                    0.744681  0.041274  0.078212     848.0     0
Architecture               0.000000  0.000000  0.000000    7765.0     1
Art                        0.000000  0.000000  0.000000   10467.0     2
Belief                     0.000000  0.000000  0.000000       6.0     3
Chemistry                  0.000000  0.000000  0.000000     452.0     4
Culture                    0.597335  0.344832  0.437248  139642.0     5
Diagrams                   0.750000  0.034555  0.066066     955.0     6
Events                     0.358140  0.003766  0.007454   20446.0     7
Food                       0.000000  0.000000  0.000000      29.0     8
Fossils                    0.464286  0.011504  0.022453    1130.0     9
Geology                    0.295455  0.006385  0.012500    2036.0    10
History                    0.638532  0.047430  0.088301   51360.0    11
Landscapes                 0.000000  0.000000  0.000000    1590.0    12
Literature                 0.000000  0.000000  0.000000     885.0    13
Logos & Symbols            0.597264  0.390268  0.472072    1007.0    14
Maps & Flags               0.767000  0.415118  0.538687    5543.0    15
Mathematics                0.909091  0.086957  0.158730     115.0    16
Medicine & Health          0.000000  0.000000  0.000000     462.0    17
Monuments & Memorials      0.000000  0.000000  0.000000     658.0    18
Music                      0.307692  0.001671  0.003324    2394.0    19
Nature                     0.744050  0.351547  0.477491   57355.0    20
People                     0.628905  0.489737  0.550664   87353.0    21
Places                     0.673294  0.703860  0.688238  150871.0    22
Plants                     0.522829  0.325793  0.401437    4288.0    23
Politics                   0.520913  0.032011  0.060315   21399.0    24
STEM                       0.728059  0.344775  0.467950   79594.0    25
Society                    0.742020  0.701285  0.721078  211027.0    26
Space                      0.000000  0.000000  0.000000     597.0    27
Sports                     0.673680  0.305887  0.420737   23865.0    28
Technology & Engineering   0.685441  0.167321  0.268982   21384.0    29
Transportation             0.666124  0.046995  0.087797    8703.0    30
micro avg                  0.686675  0.450003  0.543699  914226.0  None
macro avg                  0.419832  0.156547  0.194508  914226.0  None
weighted avg               0.651204  0.450003  0.500663  914226.0  None
samples avg                0.659455  0.513856  0.538961  914226.0  None
Ordered class in descending order of samples:
 ['Society' 'Places' 'Culture' 'People' 'STEM' 'Nature' 'History' 'Sports'
 'Politics' 'Technology & Engineering' 'Events' 'Art' 'Transportation'
 'Architecture' 'Maps & Flags' 'Plants' 'Music' 'Geology' 'Landscapes'
 'Fossils' 'Logos & Symbols' 'Diagrams' 'Literature' 'Animals'
 'Monuments & Memorials' 'Space' 'Medicine & Health' 'Chemistry'
 'Mathematics' 'Food' 'Belief']

Unweighted avg. F1-score of all classes: 0.19450754395604755
Unweighted avg. F1-score of top 5 classes: 0.57303549915221
Unweighted avg. F1-score of the rest: 0.12171370641832399


Unweighted avg. precision of all classes: 0.419831956285556
Unweighted avg. precision of top 5 classes: 0.6739228066912
Unweighted avg. precision of the rest: 0.3709683312075475


Unweighted avg. recall of all classes: 0.15654743601173926
Unweighted avg. recall of top 5 classes: 0.5168975636469892
Unweighted avg. recall of the rest: 0.08724933454342193



-------------------------- PR AUC metrics table -----------------------
Macro PR_AUC is: 0.26294460228801425
                  label_name    pr_auc  random_auc  better_than_random
0                    Animals  0.174760    0.002174              80.373
1               Architecture  0.090512    0.019910               4.546
2                        Art  0.123355    0.026838               4.596
3                     Belief  0.000149    0.000015               9.655
4                  Chemistry  0.023825    0.001159              20.557
5                    Culture  0.565237    0.358056               1.579
6                   Diagrams  0.178659    0.002449              72.960
7                     Events  0.160444    0.052426               3.060
8                       Food  0.014403    0.000074             193.694
9                    Fossils  0.130016    0.002897              44.873
10                   Geology  0.062784    0.005221              12.026
11                   History  0.301970    0.131692               2.293
12                Landscapes  0.044517    0.004077              10.919
13                Literature  0.028961    0.002269              12.763
14           Logos & Symbols  0.437538    0.002582             169.454
15              Maps & Flags  0.601695    0.014213              42.335
16               Mathematics  0.156364    0.000295             530.277
17         Medicine & Health  0.004835    0.001185               4.081
18     Monuments & Memorials  0.018419    0.001687              10.917
19                     Music  0.062585    0.006138              10.196
20                    Nature  0.561927    0.147064               3.821
21                    People  0.594985    0.223982               2.656
22                    Places  0.729373    0.386849               1.885
23                    Plants  0.417386    0.010995              37.962
24                  Politics  0.228154    0.054869               4.158
25                      STEM  0.584110    0.204087               2.862
26                   Society  0.821707    0.541095               1.519
27                     Space  0.020119    0.001531              13.143
28                    Sports  0.480512    0.061192               7.852
29  Technology & Engineering  0.345112    0.054831               6.294
30            Transportation  0.186870    0.022315               8.374


----------------------Sorted by the best PR_AUC-------------------
                  label_name    pr_auc  random_auc  better_than_random
26                   Society  0.821707    0.541095               1.519
22                    Places  0.729373    0.386849               1.885
15              Maps & Flags  0.601695    0.014213              42.335
21                    People  0.594985    0.223982               2.656
25                      STEM  0.584110    0.204087               2.862
5                    Culture  0.565237    0.358056               1.579
20                    Nature  0.561927    0.147064               3.821
28                    Sports  0.480512    0.061192               7.852
14           Logos & Symbols  0.437538    0.002582             169.454
23                    Plants  0.417386    0.010995              37.962
29  Technology & Engineering  0.345112    0.054831               6.294
11                   History  0.301970    0.131692               2.293
24                  Politics  0.228154    0.054869               4.158
30            Transportation  0.186870    0.022315               8.374
6                   Diagrams  0.178659    0.002449              72.960
0                    Animals  0.174760    0.002174              80.373
7                     Events  0.160444    0.052426               3.060
16               Mathematics  0.156364    0.000295             530.277
9                    Fossils  0.130016    0.002897              44.873
2                        Art  0.123355    0.026838               4.596
1               Architecture  0.090512    0.019910               4.546
10                   Geology  0.062784    0.005221              12.026
19                     Music  0.062585    0.006138              10.196
12                Landscapes  0.044517    0.004077              10.919
13                Literature  0.028961    0.002269              12.763
4                  Chemistry  0.023825    0.001159              20.557
27                     Space  0.020119    0.001531              13.143
18     Monuments & Memorials  0.018419    0.001687              10.917
8                       Food  0.014403    0.000074             193.694
17         Medicine & Health  0.004835    0.001185               4.081
3                     Belief  0.000149    0.000015               9.655


----------------------Sorted by the best compared to random-------------------
                  label_name    pr_auc  random_auc  better_than_random
16               Mathematics  0.156364    0.000295             530.277
8                       Food  0.014403    0.000074             193.694
14           Logos & Symbols  0.437538    0.002582             169.454
0                    Animals  0.174760    0.002174              80.373
6                   Diagrams  0.178659    0.002449              72.960
9                    Fossils  0.130016    0.002897              44.873
15              Maps & Flags  0.601695    0.014213              42.335
23                    Plants  0.417386    0.010995              37.962
4                  Chemistry  0.023825    0.001159              20.557
27                     Space  0.020119    0.001531              13.143
13                Literature  0.028961    0.002269              12.763
10                   Geology  0.062784    0.005221              12.026
12                Landscapes  0.044517    0.004077              10.919
18     Monuments & Memorials  0.018419    0.001687              10.917
19                     Music  0.062585    0.006138              10.196
3                     Belief  0.000149    0.000015               9.655
30            Transportation  0.186870    0.022315               8.374
28                    Sports  0.480512    0.061192               7.852
29  Technology & Engineering  0.345112    0.054831               6.294
2                        Art  0.123355    0.026838               4.596
1               Architecture  0.090512    0.019910               4.546
24                  Politics  0.228154    0.054869               4.158
17         Medicine & Health  0.004835    0.001185               4.081
20                    Nature  0.561927    0.147064               3.821
7                     Events  0.160444    0.052426               3.060
25                      STEM  0.584110    0.204087               2.862
21                    People  0.594985    0.223982               2.656
11                   History  0.301970    0.131692               2.293
22                    Places  0.729373    0.386849               1.885
5                    Culture  0.565237    0.358056               1.579
26                   Society  0.821707    0.541095               1.519
