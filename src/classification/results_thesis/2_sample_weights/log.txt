{'augment': False, 'oversample': False, 'undersample': False, 'loss_function': 'sample_weight', 'class_weights': False, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 0, 'hierarchical': False, 'data_folder': 'data/split_hierarchical_data_221218', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 15, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/113_bs_512'}
Time passed: 0.0 hours
09:07:12
Found 773500 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.24 hours
09:21:37
Found 136500 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
09:21:53
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
Epoch 1/15

Epoch 00001: val_loss improved from inf to 0.14219, saving model to results_thesis/113_bs_512/cp-0001.ckpt
1511/1511 - 21087s - loss: 0.1467 - binary_accuracy: 0.9395 - precision: 0.6584 - recall: 0.4132 - pr_auc: 0.2014 - val_loss: 0.1422 - val_binary_accuracy: 0.9411 - val_precision: 0.6819 - val_recall: 0.4134 - val_pr_auc: 0.2290
Epoch 2/15

Epoch 00002: val_loss improved from 0.14219 to 0.14047, saving model to results_thesis/113_bs_512/cp-0002.ckpt
1511/1511 - 16060s - loss: 0.1414 - binary_accuracy: 0.9415 - precision: 0.6788 - recall: 0.4275 - pr_auc: 0.2305 - val_loss: 0.1405 - val_binary_accuracy: 0.9420 - val_precision: 0.6887 - val_recall: 0.4237 - val_pr_auc: 0.2377
Epoch 3/15

Epoch 00003: val_loss improved from 0.14047 to 0.14013, saving model to results_thesis/113_bs_512/cp-0003.ckpt
1511/1511 - 15757s - loss: 0.1400 - binary_accuracy: 0.9421 - precision: 0.6849 - recall: 0.4321 - pr_auc: 0.2388 - val_loss: 0.1401 - val_binary_accuracy: 0.9422 - val_precision: 0.6975 - val_recall: 0.4160 - val_pr_auc: 0.2438
Epoch 4/15

Epoch 00004: val_loss improved from 0.14013 to 0.13965, saving model to results_thesis/113_bs_512/cp-0004.ckpt
1511/1511 - 15830s - loss: 0.1392 - binary_accuracy: 0.9424 - precision: 0.6880 - recall: 0.4349 - pr_auc: 0.2454 - val_loss: 0.1396 - val_binary_accuracy: 0.9424 - val_precision: 0.6868 - val_recall: 0.4386 - val_pr_auc: 0.2469
Epoch 5/15

Epoch 00005: val_loss improved from 0.13965 to 0.13937, saving model to results_thesis/113_bs_512/cp-0005.ckpt
1511/1511 - 14472s - loss: 0.1386 - binary_accuracy: 0.9426 - precision: 0.6898 - recall: 0.4374 - pr_auc: 0.2486 - val_loss: 0.1394 - val_binary_accuracy: 0.9424 - val_precision: 0.6947 - val_recall: 0.4255 - val_pr_auc: 0.2506
Epoch 6/15

Epoch 00006: val_loss improved from 0.13937 to 0.13889, saving model to results_thesis/113_bs_512/cp-0006.ckpt
1511/1511 - 15375s - loss: 0.1381 - binary_accuracy: 0.9428 - precision: 0.6910 - recall: 0.4394 - pr_auc: 0.2543 - val_loss: 0.1389 - val_binary_accuracy: 0.9427 - val_precision: 0.6807 - val_recall: 0.4569 - val_pr_auc: 0.2519
Epoch 7/15

Epoch 00007: val_loss improved from 0.13889 to 0.13870, saving model to results_thesis/113_bs_512/cp-0007.ckpt
1511/1511 - 17436s - loss: 0.1378 - binary_accuracy: 0.9430 - precision: 0.6926 - recall: 0.4415 - pr_auc: 0.2570 - val_loss: 0.1387 - val_binary_accuracy: 0.9428 - val_precision: 0.6933 - val_recall: 0.4351 - val_pr_auc: 0.2541
Epoch 8/15

Epoch 00008: val_loss did not improve from 0.13870
1511/1511 - 16434s - loss: 0.1374 - binary_accuracy: 0.9431 - precision: 0.6936 - recall: 0.4426 - pr_auc: 0.2605 - val_loss: 0.1390 - val_binary_accuracy: 0.9424 - val_precision: 0.6916 - val_recall: 0.4296 - val_pr_auc: 0.2539
Epoch 9/15

Epoch 00009: val_loss did not improve from 0.13870
1511/1511 - 16267s - loss: 0.1371 - binary_accuracy: 0.9433 - precision: 0.6946 - recall: 0.4443 - pr_auc: 0.2632 - val_loss: 0.1388 - val_binary_accuracy: 0.9428 - val_precision: 0.6863 - val_recall: 0.4479 - val_pr_auc: 0.2550
Epoch 10/15

Epoch 00010: val_loss improved from 0.13870 to 0.13854, saving model to results_thesis/113_bs_512/cp-0010.ckpt
1511/1511 - 15607s - loss: 0.1368 - binary_accuracy: 0.9434 - precision: 0.6950 - recall: 0.4458 - pr_auc: 0.2653 - val_loss: 0.1385 - val_binary_accuracy: 0.9429 - val_precision: 0.6868 - val_recall: 0.4488 - val_pr_auc: 0.2568
Epoch 11/15

Epoch 00011: val_loss did not improve from 0.13854
1511/1511 - 14782s - loss: 0.1365 - binary_accuracy: 0.9435 - precision: 0.6964 - recall: 0.4471 - pr_auc: 0.2680 - val_loss: 0.1387 - val_binary_accuracy: 0.9427 - val_precision: 0.6854 - val_recall: 0.4474 - val_pr_auc: 0.2549
Epoch 12/15

Epoch 00012: val_loss did not improve from 0.13854
1511/1511 - 16332s - loss: 0.1363 - binary_accuracy: 0.9436 - precision: 0.6968 - recall: 0.4481 - pr_auc: 0.2679 - val_loss: 0.1386 - val_binary_accuracy: 0.9430 - val_precision: 0.6893 - val_recall: 0.4476 - val_pr_auc: 0.2566
Epoch 13/15

Epoch 00013: val_loss did not improve from 0.13854
1511/1511 - 17427s - loss: 0.1360 - binary_accuracy: 0.9436 - precision: 0.6974 - recall: 0.4486 - pr_auc: 0.2715 - val_loss: 0.1388 - val_binary_accuracy: 0.9428 - val_precision: 0.6825 - val_recall: 0.4555 - val_pr_auc: 0.2582
Epoch 14/15

Epoch 00014: val_loss did not improve from 0.13854
1511/1511 - 16543s - loss: 0.1358 - binary_accuracy: 0.9438 - precision: 0.6978 - recall: 0.4504 - pr_auc: 0.2736 - val_loss: 0.1386 - val_binary_accuracy: 0.9429 - val_precision: 0.6815 - val_recall: 0.4595 - val_pr_auc: 0.2567
Epoch 15/15

Epoch 00015: val_loss did not improve from 0.13854
1511/1511 - 15723s - loss: 0.1356 - binary_accuracy: 0.9438 - precision: 0.6985 - recall: 0.4514 - pr_auc: 0.2738 - val_loss: 0.1388 - val_binary_accuracy: 0.9429 - val_precision: 0.6955 - val_recall: 0.4360 - val_pr_auc: 0.2549
Time passed: 68.14 hours
05:29:59
