Found 50000 validated image filenames belonging to 31 classes.

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
None
Found 50000 validated image filenames belonging to 31 classes.

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten_1 (Flatten)          (None, 5632)              0         
_________________________________________________________________
dense_2 (Dense)              (None, 128)               721024    
_________________________________________________________________
dense_3 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
results_thesis/101_undersample__bs_512/checkpoints/cp-0004.ckpt
Predicting on test set:

1563/1563 - 117s
METRICS FOR THRESHOLD 0.5

Mean number of label assignments per image in ground-truth: 2.3975
Mean number of label assignments per image in predictions: 1.5404

                          precision    recall  f1-score   support index
Animals                    1.000000  0.008333  0.016529     120.0     0
Architecture               0.000000  0.000000  0.000000     991.0     1
Art                        0.000000  0.000000  0.000000    1338.0     2
Belief                     0.000000  0.000000  0.000000       2.0     3
Biology                    0.604651  0.244514  0.348214     319.0     4
Chemistry                  0.000000  0.000000  0.000000      53.0     5
Culture                    0.556069  0.339305  0.421448   17026.0     6
Earth & Environment        0.000000  0.000000  0.000000      26.0     7
Entertainment              0.260870  0.003348  0.006612    1792.0     8
Events                     0.333333  0.005383  0.010594    2601.0     9
Food                       0.000000  0.000000  0.000000       4.0    10
Fossils                    0.250000  0.007194  0.013986     139.0    11
History                    0.811538  0.031301  0.060277    6741.0    12
Landscapes                 0.000000  0.000000  0.000000     190.0    13
Literature                 0.000000  0.000000  0.000000     116.0    14
Maps & Flags               0.714912  0.444142  0.547899     734.0    15
Mathematics                0.000000  0.000000  0.000000      17.0    16
Medicine & Health          0.000000  0.000000  0.000000    1798.0    17
Music                      0.333333  0.003155  0.006250     317.0    18
Nature                     0.703951  0.321711  0.441605    7199.0    19
People                     0.587435  0.447636  0.508095   10131.0    20
Physics                    0.000000  0.000000  0.000000     111.0    21
Places                     0.677999  0.675035  0.676514   19439.0    22
Plants                     0.593023  0.181495  0.277929     562.0    23
Politics                   0.569149  0.040362  0.075379    2651.0    24
STEM                       0.662558  0.305073  0.417780   11630.0    25
Society                    0.702979  0.716076  0.709467   26891.0    26
Space                      0.000000  0.000000  0.000000      59.0    27
Sports                     0.655693  0.315512  0.426025    3030.0    28
Technology & Engineering   0.671233  0.179225  0.282910    2734.0    29
Transportation             0.679245  0.032345  0.061750    1113.0    30
micro avg                  0.660655  0.424471  0.516859  119874.0  None
macro avg                  0.366709  0.138747  0.171267  119874.0  None
weighted avg               0.621309  0.424471  0.467524  119874.0  None
samples avg                0.635078  0.489210  0.509003  119874.0  None

Unweighted avg. F1-score of all classes: 0.17126654796051288
Unweighted avg. F1-score of top 5 classes: 0.48839496012131284
Unweighted avg. F1-score of the rest: 0.11028031485266676


Unweighted avg. precision of all classes: 0.3667088208709568
Unweighted avg. precision of top 5 classes: 0.6460804220042742
Unweighted avg. precision of the rest: 0.3129835129607035


Unweighted avg. recall of all classes: 0.13874656022017065
Unweighted avg. recall of top 5 classes: 0.456577678550299
Unweighted avg. recall of the rest: 0.07762519131053053

