{'augment': False, 'oversample': False, 'undersample': True, 'loss_function': 'binary_crossentropy', 'class_weights': False, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 0, 'hierarchical': False, 'data_folder': 'data/split_hierarchical_data_221129', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 15, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/101_undersample__bs_512'}
Time passed: 0.0 hours
17:10:47
Found 760000 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.1 hours
17:16:53
Found 608000 validated image filenames belonging to 31 classes.
LOG: got the new undersampled flow
Found 50000 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
00:04:47
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
Epoch 1/15

Epoch 00001: val_loss improved from inf to 0.15494, saving model to results_thesis/101_undersample__bs_512/cp-0001.ckpt
19000/19000 - 11609s - loss: 0.1703 - binary_accuracy: 0.9296 - precision: 0.6613 - recall: 0.4250 - pr_auc: 0.2269 - roc_auc: 0.6980 - fn: 963305.0000 - fp: 364712.0000 - tn: 16807880.0000 - tp: 712107.0000 - val_loss: 0.1549 - val_binary_accuracy: 0.9364 - val_precision: 0.6142 - val_recall: 0.4788 - val_pr_auc: 0.2243 - val_roc_auc: 0.7169 - val_fn: 62473.0000 - val_fp: 36059.0000 - val_tn: 1394067.0000 - val_tp: 57401.0000
Epoch 2/15

Epoch 00002: val_loss improved from 0.15494 to 0.15268, saving model to results_thesis/101_undersample__bs_512/cp-0002.ckpt
19000/19000 - 8384s - loss: 0.1667 - binary_accuracy: 0.9311 - precision: 0.6722 - recall: 0.4380 - pr_auc: 0.2439 - roc_auc: 0.7147 - fn: 941607.0000 - fp: 357784.0000 - tn: 16814802.0000 - tp: 733805.0000 - val_loss: 0.1527 - val_binary_accuracy: 0.9381 - val_precision: 0.6436 - val_recall: 0.4478 - val_pr_auc: 0.2267 - val_roc_auc: 0.7080 - val_fn: 66198.0000 - val_fp: 29719.0000 - val_tn: 1400407.0000 - val_tp: 53676.0000
Epoch 3/15

Epoch 00003: val_loss did not improve from 0.15268
19000/19000 - 3928s - loss: 0.1657 - binary_accuracy: 0.9315 - precision: 0.6754 - recall: 0.4413 - pr_auc: 0.2489 - roc_auc: 0.7178 - fn: 936007.0000 - fp: 355417.0000 - tn: 16817170.0000 - tp: 739405.0000 - val_loss: 0.1540 - val_binary_accuracy: 0.9365 - val_precision: 0.6191 - val_recall: 0.4660 - val_pr_auc: 0.2291 - val_roc_auc: 0.7098 - val_fn: 64015.0000 - val_fp: 34360.0000 - val_tn: 1395766.0000 - val_tp: 55859.0000
Epoch 4/15

Epoch 00004: val_loss improved from 0.15268 to 0.15250, saving model to results_thesis/101_undersample__bs_512/cp-0004.ckpt
19000/19000 - 2063s - loss: 0.1651 - binary_accuracy: 0.9317 - precision: 0.6766 - recall: 0.4442 - pr_auc: 0.2526 - roc_auc: 0.7205 - fn: 931135.0000 - fp: 355684.0000 - tn: 16816906.0000 - tp: 744277.0000 - val_loss: 0.1525 - val_binary_accuracy: 0.9386 - val_precision: 0.6607 - val_recall: 0.4245 - val_pr_auc: 0.2299 - val_roc_auc: 0.7124 - val_fn: 68991.0000 - val_fp: 26136.0000 - val_tn: 1403990.0000 - val_tp: 50883.0000
Epoch 5/15

Epoch 00005: val_loss did not improve from 0.15250
19000/19000 - 1560s - loss: 0.1647 - binary_accuracy: 0.9319 - precision: 0.6776 - recall: 0.4458 - pr_auc: 0.2549 - roc_auc: 0.7215 - fn: 928523.0000 - fp: 355305.0000 - tn: 16817284.0000 - tp: 746889.0000 - val_loss: 0.1556 - val_binary_accuracy: 0.9352 - val_precision: 0.5992 - val_recall: 0.4892 - val_pr_auc: 0.2315 - val_roc_auc: 0.7221 - val_fn: 61228.0000 - val_fp: 39226.0000 - val_tn: 1390900.0000 - val_tp: 58646.0000
Epoch 6/15

Epoch 00006: val_loss did not improve from 0.15250
19000/19000 - 1580s - loss: 0.1643 - binary_accuracy: 0.9321 - precision: 0.6788 - recall: 0.4476 - pr_auc: 0.2570 - roc_auc: 0.7257 - fn: 925524.0000 - fp: 354785.0000 - tn: 16817796.0000 - tp: 749888.0000 - val_loss: 0.1532 - val_binary_accuracy: 0.9369 - val_precision: 0.6205 - val_recall: 0.4747 - val_pr_auc: 0.2326 - val_roc_auc: 0.7164 - val_fn: 62964.0000 - val_fp: 34799.0000 - val_tn: 1395327.0000 - val_tp: 56910.0000
Epoch 7/15

Epoch 00007: val_loss did not improve from 0.15250
19000/19000 - 1539s - loss: 0.1640 - binary_accuracy: 0.9322 - precision: 0.6800 - recall: 0.4485 - pr_auc: 0.2584 - roc_auc: 0.7262 - fn: 924038.0000 - fp: 353550.0000 - tn: 16819048.0000 - tp: 751374.0000 - val_loss: 0.1548 - val_binary_accuracy: 0.9367 - val_precision: 0.6171 - val_recall: 0.4774 - val_pr_auc: 0.2347 - val_roc_auc: 0.7196 - val_fn: 62643.0000 - val_fp: 35507.0000 - val_tn: 1394619.0000 - val_tp: 57231.0000
Epoch 8/15

Epoch 00008: val_loss did not improve from 0.15250
19000/19000 - 1587s - loss: 0.1638 - binary_accuracy: 0.9323 - precision: 0.6800 - recall: 0.4497 - pr_auc: 0.2592 - roc_auc: 0.7279 - fn: 922061.0000 - fp: 354493.0000 - tn: 16818100.0000 - tp: 753351.0000 - val_loss: 0.1532 - val_binary_accuracy: 0.9372 - val_precision: 0.6189 - val_recall: 0.4892 - val_pr_auc: 0.2308 - val_roc_auc: 0.7124 - val_fn: 61232.0000 - val_fp: 36111.0000 - val_tn: 1394015.0000 - val_tp: 58642.0000
Epoch 9/15

Epoch 00009: val_loss did not improve from 0.15250
19000/19000 - 1567s - loss: 0.1637 - binary_accuracy: 0.9324 - precision: 0.6812 - recall: 0.4502 - pr_auc: 0.2610 - roc_auc: 0.7305 - fn: 921167.0000 - fp: 353052.0000 - tn: 16819540.0000 - tp: 754245.0000 - val_loss: 0.1533 - val_binary_accuracy: 0.9374 - val_precision: 0.6320 - val_recall: 0.4578 - val_pr_auc: 0.2345 - val_roc_auc: 0.7165 - val_fn: 64990.0000 - val_fp: 31962.0000 - val_tn: 1398164.0000 - val_tp: 54884.0000
Epoch 10/15

Epoch 00010: val_loss did not improve from 0.15250
19000/19000 - 1605s - loss: 0.1635 - binary_accuracy: 0.9325 - precision: 0.6816 - recall: 0.4507 - pr_auc: 0.2616 - roc_auc: 0.7302 - fn: 920253.0000 - fp: 352762.0000 - tn: 16819828.0000 - tp: 755159.0000 - val_loss: 0.1536 - val_binary_accuracy: 0.9365 - val_precision: 0.6129 - val_recall: 0.4869 - val_pr_auc: 0.2335 - val_roc_auc: 0.7241 - val_fn: 61513.0000 - val_fp: 36853.0000 - val_tn: 1393273.0000 - val_tp: 58361.0000
Epoch 11/15

Epoch 00011: val_loss did not improve from 0.15250
19000/19000 - 1651s - loss: 0.1633 - binary_accuracy: 0.9326 - precision: 0.6824 - recall: 0.4516 - pr_auc: 0.2625 - roc_auc: 0.7312 - fn: 918871.0000 - fp: 352044.0000 - tn: 16820544.0000 - tp: 756541.0000 - val_loss: 0.1537 - val_binary_accuracy: 0.9367 - val_precision: 0.6171 - val_recall: 0.4794 - val_pr_auc: 0.2341 - val_roc_auc: 0.7197 - val_fn: 62404.0000 - val_fp: 35652.0000 - val_tn: 1394474.0000 - val_tp: 57470.0000
Epoch 12/15

Epoch 00012: val_loss did not improve from 0.15250
19000/19000 - 1572s - loss: 0.1633 - binary_accuracy: 0.9326 - precision: 0.6829 - recall: 0.4509 - pr_auc: 0.2630 - roc_auc: 0.7311 - fn: 919932.0000 - fp: 350729.0000 - tn: 16821860.0000 - tp: 755480.0000 - val_loss: 0.1533 - val_binary_accuracy: 0.9376 - val_precision: 0.6286 - val_recall: 0.4722 - val_pr_auc: 0.2327 - val_roc_auc: 0.7235 - val_fn: 63271.0000 - val_fp: 33441.0000 - val_tn: 1396685.0000 - val_tp: 56603.0000
Epoch 13/15

Epoch 00013: val_loss did not improve from 0.15250
19000/19000 - 1519s - loss: 0.1631 - binary_accuracy: 0.9326 - precision: 0.6830 - recall: 0.4516 - pr_auc: 0.2635 - roc_auc: 0.7317 - fn: 918770.0000 - fp: 351105.0000 - tn: 16821476.0000 - tp: 756642.0000 - val_loss: 0.1543 - val_binary_accuracy: 0.9362 - val_precision: 0.6143 - val_recall: 0.4718 - val_pr_auc: 0.2316 - val_roc_auc: 0.7122 - val_fn: 63315.0000 - val_fp: 35509.0000 - val_tn: 1394617.0000 - val_tp: 56559.0000
Epoch 14/15

Epoch 00014: val_loss did not improve from 0.15250
19000/19000 - 1532s - loss: 0.1629 - binary_accuracy: 0.9327 - precision: 0.6834 - recall: 0.4517 - pr_auc: 0.2634 - roc_auc: 0.7318 - fn: 918628.0000 - fp: 350673.0000 - tn: 16821916.0000 - tp: 756784.0000 - val_loss: 0.1556 - val_binary_accuracy: 0.9362 - val_precision: 0.6112 - val_recall: 0.4816 - val_pr_auc: 0.2326 - val_roc_auc: 0.7241 - val_fn: 62147.0000 - val_fp: 36720.0000 - val_tn: 1393406.0000 - val_tp: 57727.0000
Epoch 15/15

Epoch 00015: val_loss did not improve from 0.15250
19000/19000 - 1566s - loss: 0.1629 - binary_accuracy: 0.9327 - precision: 0.6835 - recall: 0.4522 - pr_auc: 0.2643 - roc_auc: 0.7305 - fn: 917838.0000 - fp: 350745.0000 - tn: 16821838.0000 - tp: 757574.0000 - val_loss: 0.1547 - val_binary_accuracy: 0.9360 - val_precision: 0.6157 - val_recall: 0.4580 - val_pr_auc: 0.2326 - val_roc_auc: 0.7219 - val_fn: 64968.0000 - val_fp: 34276.0000 - val_tn: 1395850.0000 - val_tp: 54906.0000
Time passed: 12.02 hours
12:06:13
