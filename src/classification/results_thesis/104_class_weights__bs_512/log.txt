{'augment': False, 'oversample': False, 'undersample': False, 'loss_function': 'binary_crossentropy', 'class_weights': True, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 0, 'hierarchical': False, 'data_folder': 'data/split_hierarchical_data_221129', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 15, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/104_class_weights__bs_512'}
Time passed: 0.0 hours
13:35:35
Found 760000 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.01 hours
13:36:25
Found 50000 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
13:36:28
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
Epoch 1/15

Epoch 00001: val_loss improved from inf to 0.19079, saving model to results_thesis/104_class_weights__bs_512/cp-0001.ckpt
1485/1485 - 13205s - loss: 0.1152 - binary_accuracy: 0.9192 - precision: 0.4727 - recall: 0.3588 - pr_auc: 0.1406 - roc_auc: 0.6730 - fn: 1171770.0000 - fp: 731298.0000 - tn: 21001304.0000 - tp: 655642.0000 - val_loss: 0.1908 - val_binary_accuracy: 0.9252 - val_precision: 0.5222 - val_recall: 0.3870 - val_pr_auc: 0.1763 - val_roc_auc: 0.7074 - val_fn: 73477.0000 - val_fp: 42459.0000 - val_tn: 1387667.0000 - val_tp: 46397.0000
Epoch 2/15

Epoch 00002: val_loss improved from 0.19079 to 0.18488, saving model to results_thesis/104_class_weights__bs_512/cp-0002.ckpt
1485/1485 - 12779s - loss: 0.1015 - binary_accuracy: 0.9231 - precision: 0.5057 - recall: 0.3669 - pr_auc: 0.1611 - roc_auc: 0.7091 - fn: 1156851.0000 - fp: 655542.0000 - tn: 21077024.0000 - tp: 670561.0000 - val_loss: 0.1849 - val_binary_accuracy: 0.9270 - val_precision: 0.5379 - val_recall: 0.3944 - val_pr_auc: 0.1819 - val_roc_auc: 0.7281 - val_fn: 72597.0000 - val_fp: 40621.0000 - val_tn: 1389505.0000 - val_tp: 47277.0000
Epoch 3/15

Epoch 00003: val_loss did not improve from 0.18488
1485/1485 - 12479s - loss: 0.0951 - binary_accuracy: 0.9233 - precision: 0.5073 - recall: 0.3727 - pr_auc: 0.1714 - roc_auc: 0.7208 - fn: 1146368.0000 - fp: 661525.0000 - tn: 21071056.0000 - tp: 681044.0000 - val_loss: 0.1856 - val_binary_accuracy: 0.9270 - val_precision: 0.5397 - val_recall: 0.3781 - val_pr_auc: 0.1884 - val_roc_auc: 0.7263 - val_fn: 74554.0000 - val_fp: 38651.0000 - val_tn: 1391475.0000 - val_tp: 45320.0000
Epoch 4/15

Epoch 00004: val_loss did not improve from 0.18488
1485/1485 - 13518s - loss: 0.0898 - binary_accuracy: 0.9242 - precision: 0.5153 - recall: 0.3777 - pr_auc: 0.1810 - roc_auc: 0.7333 - fn: 1137228.0000 - fp: 649131.0000 - tn: 21083456.0000 - tp: 690184.0000 - val_loss: 0.1849 - val_binary_accuracy: 0.9266 - val_precision: 0.5352 - val_recall: 0.3843 - val_pr_auc: 0.1918 - val_roc_auc: 0.7341 - val_fn: 73803.0000 - val_fp: 40009.0000 - val_tn: 1390117.0000 - val_tp: 46071.0000
Epoch 5/15

Epoch 00005: val_loss improved from 0.18488 to 0.18464, saving model to results_thesis/104_class_weights__bs_512/cp-0005.ckpt
1485/1485 - 13067s - loss: 0.0867 - binary_accuracy: 0.9251 - precision: 0.5240 - recall: 0.3800 - pr_auc: 0.1873 - roc_auc: 0.7412 - fn: 1132907.0000 - fp: 630774.0000 - tn: 21101816.0000 - tp: 694505.0000 - val_loss: 0.1846 - val_binary_accuracy: 0.9266 - val_precision: 0.5361 - val_recall: 0.3747 - val_pr_auc: 0.1923 - val_roc_auc: 0.7293 - val_fn: 74963.0000 - val_fp: 38857.0000 - val_tn: 1391269.0000 - val_tp: 44911.0000
Epoch 6/15

Epoch 00006: val_loss did not improve from 0.18464
1485/1485 - 12735s - loss: 0.0844 - binary_accuracy: 0.9252 - precision: 0.5241 - recall: 0.3854 - pr_auc: 0.1925 - roc_auc: 0.7454 - fn: 1123083.0000 - fp: 639520.0000 - tn: 21093084.0000 - tp: 704329.0000 - val_loss: 0.1888 - val_binary_accuracy: 0.9235 - val_precision: 0.5077 - val_recall: 0.3737 - val_pr_auc: 0.1971 - val_roc_auc: 0.7338 - val_fn: 75075.0000 - val_fp: 43434.0000 - val_tn: 1386692.0000 - val_tp: 44799.0000
Epoch 7/15

Epoch 00007: val_loss improved from 0.18464 to 0.18305, saving model to results_thesis/104_class_weights__bs_512/cp-0007.ckpt
1485/1485 - 16238s - loss: 0.0852 - binary_accuracy: 0.9248 - precision: 0.5208 - recall: 0.3841 - pr_auc: 0.1906 - roc_auc: 0.7467 - fn: 1125509.0000 - fp: 645869.0000 - tn: 21086724.0000 - tp: 701903.0000 - val_loss: 0.1831 - val_binary_accuracy: 0.9275 - val_precision: 0.5448 - val_recall: 0.3763 - val_pr_auc: 0.1979 - val_roc_auc: 0.7282 - val_fn: 74770.0000 - val_fp: 37681.0000 - val_tn: 1392445.0000 - val_tp: 45104.0000
Epoch 8/15

Epoch 00008: val_loss improved from 0.18305 to 0.18126, saving model to results_thesis/104_class_weights__bs_512/cp-0008.ckpt
1485/1485 - 19231s - loss: 0.0821 - binary_accuracy: 0.9257 - precision: 0.5292 - recall: 0.3836 - pr_auc: 0.1953 - roc_auc: 0.7517 - fn: 1126403.0000 - fp: 623540.0000 - tn: 21109042.0000 - tp: 701009.0000 - val_loss: 0.1813 - val_binary_accuracy: 0.9275 - val_precision: 0.5436 - val_recall: 0.3907 - val_pr_auc: 0.1952 - val_roc_auc: 0.7257 - val_fn: 73040.0000 - val_fp: 39328.0000 - val_tn: 1390798.0000 - val_tp: 46834.0000
Epoch 9/15

Epoch 00009: val_loss did not improve from 0.18126
1485/1485 - 10998s - loss: 0.0818 - binary_accuracy: 0.9255 - precision: 0.5271 - recall: 0.3874 - pr_auc: 0.1951 - roc_auc: 0.7517 - fn: 1119429.0000 - fp: 635251.0000 - tn: 21097336.0000 - tp: 707983.0000 - val_loss: 0.1868 - val_binary_accuracy: 0.9261 - val_precision: 0.5326 - val_recall: 0.3583 - val_pr_auc: 0.1988 - val_roc_auc: 0.7324 - val_fn: 76921.0000 - val_fp: 37697.0000 - val_tn: 1392429.0000 - val_tp: 42953.0000
Epoch 10/15

Epoch 00010: val_loss improved from 0.18126 to 0.18006, saving model to results_thesis/104_class_weights__bs_512/cp-0010.ckpt
1485/1485 - 14529s - loss: 0.0812 - binary_accuracy: 0.9257 - precision: 0.5285 - recall: 0.3867 - pr_auc: 0.1994 - roc_auc: 0.7531 - fn: 1120839.0000 - fp: 630421.0000 - tn: 21102180.0000 - tp: 706573.0000 - val_loss: 0.1801 - val_binary_accuracy: 0.9276 - val_precision: 0.5420 - val_recall: 0.4109 - val_pr_auc: 0.1982 - val_roc_auc: 0.7357 - val_fn: 70612.0000 - val_fp: 41634.0000 - val_tn: 1388492.0000 - val_tp: 49262.0000
Epoch 11/15

Epoch 00011: val_loss did not improve from 0.18006
1485/1485 - 11691s - loss: 0.0801 - binary_accuracy: 0.9258 - precision: 0.5293 - recall: 0.3910 - pr_auc: 0.2025 - roc_auc: 0.7525 - fn: 1112957.0000 - fp: 635335.0000 - tn: 21097268.0000 - tp: 714455.0000 - val_loss: 0.1802 - val_binary_accuracy: 0.9280 - val_precision: 0.5499 - val_recall: 0.3787 - val_pr_auc: 0.2033 - val_roc_auc: 0.7292 - val_fn: 74480.0000 - val_fp: 37161.0000 - val_tn: 1392965.0000 - val_tp: 45394.0000
Epoch 12/15

Epoch 00012: val_loss improved from 0.18006 to 0.17959, saving model to results_thesis/104_class_weights__bs_512/cp-0012.ckpt
1485/1485 - 10800s - loss: 0.0788 - binary_accuracy: 0.9261 - precision: 0.5323 - recall: 0.3888 - pr_auc: 0.2079 - roc_auc: 0.7568 - fn: 1116825.0000 - fp: 624363.0000 - tn: 21108224.0000 - tp: 710587.0000 - val_loss: 0.1796 - val_binary_accuracy: 0.9282 - val_precision: 0.5471 - val_recall: 0.4183 - val_pr_auc: 0.2046 - val_roc_auc: 0.7311 - val_fn: 69732.0000 - val_fp: 41509.0000 - val_tn: 1388617.0000 - val_tp: 50142.0000
Epoch 13/15
