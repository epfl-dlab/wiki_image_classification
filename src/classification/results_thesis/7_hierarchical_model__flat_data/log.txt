{'augment': False, 'oversample': False, 'undersample': False, 'loss_function': 'binary_crossentropy', 'class_weights': False, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 'all', 'hierarchical': True, 'data_folder': 'data/split_flat_data_221216', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 15, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/110_hierarchical__bs_512'}
Time passed: 0.0 hours
11:33:03
Found 773500 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.15 hours
11:42:00
Found 136500 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
11:42:19
LOG: creating and training model
LOG: Getting hierarchical model...
Epoch 1/15

Epoch 00001: val_loss improved from inf to 0.16221, saving model to results_thesis/110_hierarchical__bs_512/cp-0001.ckpt
500/500 - 10630s - loss: 0.1693 - binary_accuracy: 0.9414 - recall: 0.0073 - precision: 0.1766 - pr_auc: 0.0571 - val_loss: 0.1622 - val_binary_accuracy: 0.9430 - val_recall: 0.0000e+00 - val_precision: 0.0000e+00 - val_pr_auc: 0.0570
Epoch 2/15

Epoch 00002: val_loss improved from 0.16221 to 0.15988, saving model to results_thesis/110_hierarchical__bs_512/cp-0002.ckpt
500/500 - 11286s - loss: 0.1629 - binary_accuracy: 0.9428 - recall: 0.0036 - precision: 0.3742 - pr_auc: 0.0582 - val_loss: 0.1599 - val_binary_accuracy: 0.9446 - val_recall: 0.1087 - val_precision: 0.5745 - val_pr_auc: 0.0688
Epoch 3/15

Epoch 00003: val_loss improved from 0.15988 to 0.15302, saving model to results_thesis/110_hierarchical__bs_512/cp-0003.ckpt
500/500 - 7715s - loss: 0.1560 - binary_accuracy: 0.9452 - recall: 0.0967 - precision: 0.6255 - pr_auc: 0.0826 - val_loss: 0.1530 - val_binary_accuracy: 0.9457 - val_recall: 0.1087 - val_precision: 0.6375 - val_pr_auc: 0.0973
Epoch 4/15

Epoch 00004: val_loss improved from 0.15302 to 0.14969, saving model to results_thesis/110_hierarchical__bs_512/cp-0004.ckpt
500/500 - 6882s - loss: 0.1515 - binary_accuracy: 0.9456 - recall: 0.1097 - precision: 0.6345 - pr_auc: 0.1074 - val_loss: 0.1497 - val_binary_accuracy: 0.9458 - val_recall: 0.1162 - val_precision: 0.6374 - val_pr_auc: 0.1221
Epoch 5/15

Epoch 00005: val_loss improved from 0.14969 to 0.14769, saving model to results_thesis/110_hierarchical__bs_512/cp-0005.ckpt
500/500 - 6699s - loss: 0.1487 - binary_accuracy: 0.9458 - recall: 0.1175 - precision: 0.6402 - pr_auc: 0.1254 - val_loss: 0.1477 - val_binary_accuracy: 0.9460 - val_recall: 0.1120 - val_precision: 0.6521 - val_pr_auc: 0.1347
Epoch 6/15

Epoch 00006: val_loss improved from 0.14769 to 0.14642, saving model to results_thesis/110_hierarchical__bs_512/cp-0006.ckpt
500/500 - 6532s - loss: 0.1469 - binary_accuracy: 0.9461 - recall: 0.1213 - precision: 0.6431 - pr_auc: 0.1385 - val_loss: 0.1464 - val_binary_accuracy: 0.9460 - val_recall: 0.1429 - val_precision: 0.6115 - val_pr_auc: 0.1476
Epoch 7/15

Epoch 00007: val_loss improved from 0.14642 to 0.14545, saving model to results_thesis/110_hierarchical__bs_512/cp-0007.ckpt
500/500 - 6345s - loss: 0.1455 - binary_accuracy: 0.9461 - recall: 0.1257 - precision: 0.6453 - pr_auc: 0.1485 - val_loss: 0.1455 - val_binary_accuracy: 0.9462 - val_recall: 0.1187 - val_precision: 0.6578 - val_pr_auc: 0.1519
Epoch 8/15

Epoch 00008: val_loss improved from 0.14545 to 0.14431, saving model to results_thesis/110_hierarchical__bs_512/cp-0008.ckpt
500/500 - 5677s - loss: 0.1444 - binary_accuracy: 0.9463 - recall: 0.1300 - precision: 0.6462 - pr_auc: 0.1554 - val_loss: 0.1443 - val_binary_accuracy: 0.9463 - val_recall: 0.1416 - val_precision: 0.6305 - val_pr_auc: 0.1576
Epoch 9/15

Epoch 00009: val_loss improved from 0.14431 to 0.14353, saving model to results_thesis/110_hierarchical__bs_512/cp-0009.ckpt
500/500 - 4032s - loss: 0.1434 - binary_accuracy: 0.9464 - recall: 0.1325 - precision: 0.6490 - pr_auc: 0.1633 - val_loss: 0.1435 - val_binary_accuracy: 0.9465 - val_recall: 0.1378 - val_precision: 0.6427 - val_pr_auc: 0.1652
Epoch 10/15

Epoch 00010: val_loss improved from 0.14353 to 0.14308, saving model to results_thesis/110_hierarchical__bs_512/cp-0010.ckpt
500/500 - 3867s - loss: 0.1425 - binary_accuracy: 0.9465 - recall: 0.1382 - precision: 0.6463 - pr_auc: 0.1690 - val_loss: 0.1431 - val_binary_accuracy: 0.9465 - val_recall: 0.1404 - val_precision: 0.6399 - val_pr_auc: 0.1669
Epoch 11/15

Epoch 00011: val_loss improved from 0.14308 to 0.14285, saving model to results_thesis/110_hierarchical__bs_512/cp-0011.ckpt
500/500 - 3563s - loss: 0.1418 - binary_accuracy: 0.9467 - recall: 0.1403 - precision: 0.6538 - pr_auc: 0.1744 - val_loss: 0.1428 - val_binary_accuracy: 0.9464 - val_recall: 0.1134 - val_precision: 0.6825 - val_pr_auc: 0.1705
Epoch 12/15

Epoch 00012: val_loss improved from 0.14285 to 0.14262, saving model to results_thesis/110_hierarchical__bs_512/cp-0012.ckpt
500/500 - 3261s - loss: 0.1413 - binary_accuracy: 0.9468 - recall: 0.1432 - precision: 0.6545 - pr_auc: 0.1775 - val_loss: 0.1426 - val_binary_accuracy: 0.9462 - val_recall: 0.1083 - val_precision: 0.6744 - val_pr_auc: 0.1707
Epoch 13/15

Epoch 00013: val_loss improved from 0.14262 to 0.14193, saving model to results_thesis/110_hierarchical__bs_512/cp-0013.ckpt
500/500 - 3476s - loss: 0.1406 - binary_accuracy: 0.9469 - recall: 0.1466 - precision: 0.6569 - pr_auc: 0.1848 - val_loss: 0.1419 - val_binary_accuracy: 0.9467 - val_recall: 0.1523 - val_precision: 0.6339 - val_pr_auc: 0.1742
Epoch 14/15

Epoch 00014: val_loss improved from 0.14193 to 0.14184, saving model to results_thesis/110_hierarchical__bs_512/cp-0014.ckpt
500/500 - 5299s - loss: 0.1400 - binary_accuracy: 0.9470 - recall: 0.1501 - precision: 0.6585 - pr_auc: 0.1869 - val_loss: 0.1418 - val_binary_accuracy: 0.9467 - val_recall: 0.1575 - val_precision: 0.6313 - val_pr_auc: 0.1758
Epoch 15/15

Epoch 00015: val_loss did not improve from 0.14184
500/500 - 6035s - loss: 0.1395 - binary_accuracy: 0.9472 - recall: 0.1516 - precision: 0.6592 - pr_auc: 0.1932 - val_loss: 0.1419 - val_binary_accuracy: 0.9466 - val_recall: 0.1355 - val_precision: 0.6505 - val_pr_auc: 0.1779
Time passed: 25.4 hours
13:06:32
