{'augment': False, 'oversample': False, 'undersample': False, 'loss_function': 'focal_loss', 'class_weights': False, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 0, 'hierarchical': False, 'data_folder': 'data/split_hierarchical_data_221129', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 15, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/106_bs_512'}
Time passed: 0.0 hours
18:11:01
Found 760000 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.01 hours
18:11:46
Found 50000 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
18:11:49
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
Epoch 1/15

Epoch 00001: val_loss improved from inf to 0.15166, saving model to results_thesis/106_bs_512/cp-0001.ckpt
1485/1485 - 14272s - loss: 0.1566 - binary_accuracy: 0.9366 - precision: 0.6536 - recall: 0.3876 - pr_auc: 0.1992 - val_loss: 0.1517 - val_binary_accuracy: 0.9385 - val_precision: 0.6760 - val_recall: 0.3945 - val_pr_auc: 0.2280
Epoch 2/15

Epoch 00002: val_loss improved from 0.15166 to 0.14997, saving model to results_thesis/106_bs_512/cp-0002.ckpt
1485/1485 - 15054s - loss: 0.1513 - binary_accuracy: 0.9386 - precision: 0.6749 - recall: 0.4019 - pr_auc: 0.2279 - val_loss: 0.1500 - val_binary_accuracy: 0.9393 - val_precision: 0.6862 - val_recall: 0.3952 - val_pr_auc: 0.2372
Epoch 3/15

Epoch 00003: val_loss improved from 0.14997 to 0.14945, saving model to results_thesis/106_bs_512/cp-0003.ckpt
1485/1485 - 13866s - loss: 0.1498 - binary_accuracy: 0.9392 - precision: 0.6808 - recall: 0.4070 - pr_auc: 0.2354 - val_loss: 0.1495 - val_binary_accuracy: 0.9394 - val_precision: 0.6815 - val_recall: 0.4075 - val_pr_auc: 0.2408
Epoch 4/15

Epoch 00004: val_loss improved from 0.14945 to 0.14876, saving model to results_thesis/106_bs_512/cp-0004.ckpt
1485/1485 - 15622s - loss: 0.1490 - binary_accuracy: 0.9395 - precision: 0.6837 - recall: 0.4097 - pr_auc: 0.2410 - val_loss: 0.1488 - val_binary_accuracy: 0.9397 - val_precision: 0.6794 - val_recall: 0.4162 - val_pr_auc: 0.2421
Epoch 5/15

Epoch 00005: val_loss did not improve from 0.14876
1485/1485 - 15122s - loss: 0.1484 - binary_accuracy: 0.9397 - precision: 0.6857 - recall: 0.4119 - pr_auc: 0.2451 - val_loss: 0.1488 - val_binary_accuracy: 0.9397 - val_precision: 0.6745 - val_recall: 0.4255 - val_pr_auc: 0.2443
Epoch 6/15

Epoch 00006: val_loss did not improve from 0.14876
1485/1485 - 14337s - loss: 0.1480 - binary_accuracy: 0.9399 - precision: 0.6869 - recall: 0.4138 - pr_auc: 0.2478 - val_loss: 0.1488 - val_binary_accuracy: 0.9396 - val_precision: 0.6736 - val_recall: 0.4259 - val_pr_auc: 0.2436
Epoch 7/15

Epoch 00007: val_loss improved from 0.14876 to 0.14855, saving model to results_thesis/106_bs_512/cp-0007.ckpt
1485/1485 - 13296s - loss: 0.1475 - binary_accuracy: 0.9401 - precision: 0.6881 - recall: 0.4162 - pr_auc: 0.2507 - val_loss: 0.1486 - val_binary_accuracy: 0.9399 - val_precision: 0.6774 - val_recall: 0.4251 - val_pr_auc: 0.2481
Epoch 8/15

Epoch 00008: val_loss improved from 0.14855 to 0.14848, saving model to results_thesis/106_bs_512/cp-0008.ckpt
1485/1485 - 13692s - loss: 0.1472 - binary_accuracy: 0.9402 - precision: 0.6894 - recall: 0.4175 - pr_auc: 0.2536 - val_loss: 0.1485 - val_binary_accuracy: 0.9399 - val_precision: 0.6788 - val_recall: 0.4220 - val_pr_auc: 0.2480
Epoch 9/15

Epoch 00009: val_loss improved from 0.14848 to 0.14820, saving model to results_thesis/106_bs_512/cp-0009.ckpt
1485/1485 - 12527s - loss: 0.1469 - binary_accuracy: 0.9403 - precision: 0.6897 - recall: 0.4185 - pr_auc: 0.2567 - val_loss: 0.1482 - val_binary_accuracy: 0.9401 - val_precision: 0.6838 - val_recall: 0.4201 - val_pr_auc: 0.2511
Epoch 10/15

Epoch 00010: val_loss did not improve from 0.14820
1485/1485 - 10115s - loss: 0.1466 - binary_accuracy: 0.9404 - precision: 0.6907 - recall: 0.4204 - pr_auc: 0.2584 - val_loss: 0.1484 - val_binary_accuracy: 0.9401 - val_precision: 0.6914 - val_recall: 0.4078 - val_pr_auc: 0.2489
Epoch 11/15

Epoch 00011: val_loss did not improve from 0.14820
1485/1485 - 6907s - loss: 0.1463 - binary_accuracy: 0.9406 - precision: 0.6921 - recall: 0.4214 - pr_auc: 0.2605 - val_loss: 0.1482 - val_binary_accuracy: 0.9400 - val_precision: 0.6867 - val_recall: 0.4112 - val_pr_auc: 0.2476
Epoch 12/15

Epoch 00012: val_loss did not improve from 0.14820
1485/1485 - 13757s - loss: 0.1461 - binary_accuracy: 0.9406 - precision: 0.6924 - recall: 0.4221 - pr_auc: 0.2623 - val_loss: 0.1482 - val_binary_accuracy: 0.9401 - val_precision: 0.6900 - val_recall: 0.4089 - val_pr_auc: 0.2480
Epoch 13/15

Epoch 00013: val_loss improved from 0.14820 to 0.14806, saving model to results_thesis/106_bs_512/cp-0013.ckpt
1485/1485 - 15883s - loss: 0.1459 - binary_accuracy: 0.9407 - precision: 0.6928 - recall: 0.4234 - pr_auc: 0.2626 - val_loss: 0.1481 - val_binary_accuracy: 0.9401 - val_precision: 0.6850 - val_recall: 0.4176 - val_pr_auc: 0.2481
Epoch 14/15

Epoch 00014: val_loss did not improve from 0.14806
1485/1485 - 15498s - loss: 0.1457 - binary_accuracy: 0.9408 - precision: 0.6933 - recall: 0.4243 - pr_auc: 0.2646 - val_loss: 0.1483 - val_binary_accuracy: 0.9400 - val_precision: 0.6781 - val_recall: 0.4260 - val_pr_auc: 0.2510
Epoch 15/15

Epoch 00015: val_loss did not improve from 0.14806
1485/1485 - 12788s - loss: 0.1455 - binary_accuracy: 0.9408 - precision: 0.6938 - recall: 0.4247 - pr_auc: 0.2666 - val_loss: 0.1483 - val_binary_accuracy: 0.9401 - val_precision: 0.6819 - val_recall: 0.4222 - val_pr_auc: 0.2513
Time passed: 56.35 hours
02:32:59
