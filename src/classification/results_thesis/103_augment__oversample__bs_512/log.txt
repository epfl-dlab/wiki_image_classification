{'augment': True, 'oversample': True, 'undersample': False, 'loss_function': 'binary_crossentropy', 'class_weights': False, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 0, 'hierarchical': False, 'data_folder': 'data/split_hierarchical_data_221129', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 15, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/103_augment__oversample__bs_512'}
Time passed: 0.0 hours
23:20:38
Found 760000 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.03 hours
23:22:33
LOG: oversampling....
Time passed: 0.58 hours
23:57:20
LOG: found indices to duplicate...
LOG: starting to get new flow...
Found 911872 validated image filenames belonging to 31 classes.
LOG: got augmented dataset
LOG: got the new oversampled flow
Time passed: 0.01 hours
23:57:38
Found 50000 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.01 hours
23:58:03
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 0

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 725,023
Non-trainable params: 7,768,569
_________________________________________________________________
will try with augment
Epoch 1/15

Epoch 00001: val_loss improved from inf to 0.57091, saving model to results_thesis/103_augment__oversample__bs_512/cp-0001.ckpt
1781/1781 - 11405s - loss: 0.1896 - binary_accuracy: 0.9265 - precision: 0.7123 - recall: 0.5396 - pr_auc: 0.5888 - roc_auc: 0.8722 - fn: 1410196.0000 - fp: 667528.0000 - tn: 24537840.0000 - tp: 1652468.0000 - val_loss: 0.5709 - val_binary_accuracy: 0.7482 - val_precision: 0.1982 - val_recall: 0.7408 - val_pr_auc: 0.0962 - val_roc_auc: 0.6134 - val_fn: 30872.0000 - val_fp: 356823.0000 - val_tn: 1063672.0000 - val_tp: 88217.0000
Epoch 2/15

Epoch 00002: val_loss did not improve from 0.57091
1781/1781 - 12340s - loss: 0.1597 - binary_accuracy: 0.9368 - precision: 0.7829 - recall: 0.5767 - pr_auc: 0.6927 - roc_auc: 0.8876 - fn: 1296324.0000 - fp: 489861.0000 - tn: 24715502.0000 - tp: 1766340.0000 - val_loss: 0.9962 - val_binary_accuracy: 0.7699 - val_precision: 0.2051 - val_recall: 0.6866 - val_pr_auc: 0.0924 - val_roc_auc: 0.5659 - val_fn: 37317.0000 - val_fp: 316907.0000 - val_tn: 1103588.0000 - val_tp: 81772.0000
Epoch 3/15

Epoch 00003: val_loss did not improve from 0.57091
1781/1781 - 15268s - loss: 0.1573 - binary_accuracy: 0.9383 - precision: 0.7933 - recall: 0.5818 - pr_auc: 0.7167 - roc_auc: 0.8945 - fn: 1280695.0000 - fp: 464315.0000 - tn: 24741070.0000 - tp: 1781969.0000 - val_loss: 1.0558 - val_binary_accuracy: 0.7761 - val_precision: 0.1990 - val_recall: 0.6263 - val_pr_auc: 0.0890 - val_roc_auc: 0.5346 - val_fn: 44507.0000 - val_fp: 300151.0000 - val_tn: 1120344.0000 - val_tp: 74582.0000
Epoch 4/15

Epoch 00004: val_loss improved from 0.57091 to 0.46140, saving model to results_thesis/103_augment__oversample__bs_512/cp-0004.ckpt
1781/1781 - 19363s - loss: 0.1508 - binary_accuracy: 0.9406 - precision: 0.8079 - recall: 0.5933 - pr_auc: 0.7514 - roc_auc: 0.9002 - fn: 1245687.0000 - fp: 432119.0000 - tn: 24773250.0000 - tp: 1816977.0000 - val_loss: 0.4614 - val_binary_accuracy: 0.8398 - val_precision: 0.2671 - val_recall: 0.6142 - val_pr_auc: 0.1091 - val_roc_auc: 0.5696 - val_fn: 45941.0000 - val_fp: 200707.0000 - val_tn: 1219788.0000 - val_tp: 73148.0000
Epoch 5/15

Epoch 00005: val_loss did not improve from 0.46140
1781/1781 - 17962s - loss: 0.1416 - binary_accuracy: 0.9430 - precision: 0.8182 - recall: 0.6095 - pr_auc: 0.7811 - roc_auc: 0.9090 - fn: 1195916.0000 - fp: 414806.0000 - tn: 24790556.0000 - tp: 1866748.0000 - val_loss: 0.4755 - val_binary_accuracy: 0.8249 - val_precision: 0.2535 - val_recall: 0.6494 - val_pr_auc: 0.0962 - val_roc_auc: 0.5178 - val_fn: 41757.0000 - val_fp: 227781.0000 - val_tn: 1192714.0000 - val_tp: 77332.0000
Epoch 6/15

Epoch 00006: val_loss improved from 0.46140 to 0.41168, saving model to results_thesis/103_augment__oversample__bs_512/cp-0006.ckpt
1781/1781 - 13928s - loss: 0.1369 - binary_accuracy: 0.9448 - precision: 0.8275 - recall: 0.6194 - pr_auc: 0.7997 - roc_auc: 0.9146 - fn: 1165504.0000 - fp: 395549.0000 - tn: 24809830.0000 - tp: 1897160.0000 - val_loss: 0.4117 - val_binary_accuracy: 0.8403 - val_precision: 0.2686 - val_recall: 0.6183 - val_pr_auc: 0.1064 - val_roc_auc: 0.5753 - val_fn: 45462.0000 - val_fp: 200467.0000 - val_tn: 1220028.0000 - val_tp: 73627.0000
Epoch 7/15

Epoch 00007: val_loss improved from 0.41168 to 0.39202, saving model to results_thesis/103_augment__oversample__bs_512/cp-0007.ckpt
1781/1781 - 13919s - loss: 0.1344 - binary_accuracy: 0.9457 - precision: 0.8306 - recall: 0.6264 - pr_auc: 0.8081 - roc_auc: 0.9164 - fn: 1144096.0000 - fp: 391372.0000 - tn: 24814028.0000 - tp: 1918568.0000 - val_loss: 0.3920 - val_binary_accuracy: 0.8429 - val_precision: 0.2723 - val_recall: 0.6168 - val_pr_auc: 0.1021 - val_roc_auc: 0.5542 - val_fn: 45629.0000 - val_fp: 196277.0000 - val_tn: 1224218.0000 - val_tp: 73460.0000
Epoch 8/15

Epoch 00008: val_loss improved from 0.39202 to 0.37664, saving model to results_thesis/103_augment__oversample__bs_512/cp-0008.ckpt
1781/1781 - 14183s - loss: 0.1350 - binary_accuracy: 0.9455 - precision: 0.8319 - recall: 0.6225 - pr_auc: 0.8050 - roc_auc: 0.9151 - fn: 1156117.0000 - fp: 385341.0000 - tn: 24820028.0000 - tp: 1906547.0000 - val_loss: 0.3766 - val_binary_accuracy: 0.8510 - val_precision: 0.2787 - val_recall: 0.5834 - val_pr_auc: 0.1165 - val_roc_auc: 0.5776 - val_fn: 49607.0000 - val_fp: 179856.0000 - val_tn: 1240639.0000 - val_tp: 69482.0000
Epoch 9/15

Epoch 00009: val_loss did not improve from 0.37664
1781/1781 - 13958s - loss: 0.1333 - binary_accuracy: 0.9467 - precision: 0.8375 - recall: 0.6309 - pr_auc: 0.8096 - roc_auc: 0.9175 - fn: 1130550.0000 - fp: 374858.0000 - tn: 24830512.0000 - tp: 1932114.0000 - val_loss: 0.4004 - val_binary_accuracy: 0.8443 - val_precision: 0.2712 - val_recall: 0.6003 - val_pr_auc: 0.1107 - val_roc_auc: 0.5861 - val_fn: 47604.0000 - val_fp: 192069.0000 - val_tn: 1228426.0000 - val_tp: 71485.0000
Epoch 10/15

Epoch 00010: val_loss did not improve from 0.37664
1781/1781 - 13982s - loss: 0.1315 - binary_accuracy: 0.9474 - precision: 0.8417 - recall: 0.6337 - pr_auc: 0.8172 - roc_auc: 0.9191 - fn: 1121835.0000 - fp: 365053.0000 - tn: 24840318.0000 - tp: 1940829.0000 - val_loss: 0.4285 - val_binary_accuracy: 0.8303 - val_precision: 0.2548 - val_recall: 0.6201 - val_pr_auc: 0.1031 - val_roc_auc: 0.5612 - val_fn: 45244.0000 - val_fp: 215978.0000 - val_tn: 1204517.0000 - val_tp: 73845.0000
Epoch 11/15

Epoch 00011: val_loss improved from 0.37664 to 0.36416, saving model to results_thesis/103_augment__oversample__bs_512/cp-0011.ckpt
1781/1781 - 14415s - loss: 0.1303 - binary_accuracy: 0.9477 - precision: 0.8441 - recall: 0.6350 - pr_auc: 0.8187 - roc_auc: 0.9191 - fn: 1117774.0000 - fp: 359259.0000 - tn: 24846094.0000 - tp: 1944890.0000 - val_loss: 0.3642 - val_binary_accuracy: 0.8575 - val_precision: 0.2848 - val_recall: 0.5574 - val_pr_auc: 0.1150 - val_roc_auc: 0.5761 - val_fn: 52711.0000 - val_fp: 166699.0000 - val_tn: 1253796.0000 - val_tp: 66378.0000
Epoch 12/15

Epoch 00012: val_loss improved from 0.36416 to 0.30443, saving model to results_thesis/103_augment__oversample__bs_512/cp-0012.ckpt
1781/1781 - 16368s - loss: 0.1292 - binary_accuracy: 0.9481 - precision: 0.8463 - recall: 0.6361 - pr_auc: 0.8204 - roc_auc: 0.9199 - fn: 1114527.0000 - fp: 353704.0000 - tn: 24851676.0000 - tp: 1948137.0000 - val_loss: 0.3044 - val_binary_accuracy: 0.8772 - val_precision: 0.3313 - val_recall: 0.5766 - val_pr_auc: 0.1264 - val_roc_auc: 0.6217 - val_fn: 50424.0000 - val_fp: 138614.0000 - val_tn: 1281881.0000 - val_tp: 68665.0000
Epoch 13/15

Epoch 00013: val_loss improved from 0.30443 to 0.23390, saving model to results_thesis/103_augment__oversample__bs_512/cp-0013.ckpt
1781/1781 - 15618s - loss: 0.1272 - binary_accuracy: 0.9487 - precision: 0.8471 - recall: 0.6426 - pr_auc: 0.8267 - roc_auc: 0.9234 - fn: 1094478.0000 - fp: 355193.0000 - tn: 24850172.0000 - tp: 1968186.0000 - val_loss: 0.2339 - val_binary_accuracy: 0.9073 - val_precision: 0.4238 - val_recall: 0.5535 - val_pr_auc: 0.1559 - val_roc_auc: 0.6743 - val_fn: 53168.0000 - val_fp: 89619.0000 - val_tn: 1330876.0000 - val_tp: 65921.0000
