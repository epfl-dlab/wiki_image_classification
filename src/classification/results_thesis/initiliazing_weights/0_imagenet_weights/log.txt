{'epochs': 30, 'augment': False, 'basemodel': 'EfficientNetB2', 'nr_classes': 20, 'batch_size': 512, 'undersample': False, 'data_folder': 'data/split_dataframes_heuristic_labels_20221006', 'loss_function': 'binary_crossentropy', 'class_weights': False, 'image_dimension': 64, 'random_initialization': False, 'number_trainable_layers': 339, 'results_folder': 'thesis_experiments/0_imagenet_weights'}
Time passed: 0.0 hours
18:10:55
Found 760000 non-validated image filenames belonging to 42 classes.
Found 752497 validated image filenames belonging to 20 classes.
LOG: finished getting the first flow
Time passed: 0.22 hours
18:24:08
Found 50000 non-validated image filenames belonging to 40 classes.
Found 49514 validated image filenames belonging to 20 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
18:24:10
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 20)                2580      
=================================================================
Total params: 8,492,173
Trainable params: 8,424,598
Non-trainable params: 67,575
_________________________________________________________________
Epoch 1/30

Epoch 00001: val_loss improved from inf to 0.22098, saving model to thesis_experiments/0_imagenet_weights/cp-0001.ckpt
1470/1470 - 17147s - loss: 0.2285 - accuracy: 0.2841 - categorical_accuracy: 0.2841 - val_loss: 0.2210 - val_accuracy: 0.2914 - val_categorical_accuracy: 0.2914
Epoch 2/30

Epoch 00002: val_loss improved from 0.22098 to 0.21953, saving model to thesis_experiments/0_imagenet_weights/cp-0002.ckpt
1470/1470 - 15657s - loss: 0.2179 - accuracy: 0.3034 - categorical_accuracy: 0.3034 - val_loss: 0.2195 - val_accuracy: 0.3076 - val_categorical_accuracy: 0.3076
Epoch 3/30

Epoch 00003: val_loss improved from 0.21953 to 0.21725, saving model to thesis_experiments/0_imagenet_weights/cp-0003.ckpt
1470/1470 - 14550s - loss: 0.2142 - accuracy: 0.3116 - categorical_accuracy: 0.3116 - val_loss: 0.2172 - val_accuracy: 0.3084 - val_categorical_accuracy: 0.3084
Epoch 4/30

Epoch 00004: val_loss did not improve from 0.21725
1470/1470 - 12779s - loss: 0.2110 - accuracy: 0.3185 - categorical_accuracy: 0.3185 - val_loss: 0.2174 - val_accuracy: 0.3169 - val_categorical_accuracy: 0.3169
Epoch 5/30

Epoch 00005: val_loss improved from 0.21725 to 0.21698, saving model to thesis_experiments/0_imagenet_weights/cp-0005.ckpt
1470/1470 - 12890s - loss: 0.2079 - accuracy: 0.3247 - categorical_accuracy: 0.3247 - val_loss: 0.2170 - val_accuracy: 0.3062 - val_categorical_accuracy: 0.3062
Epoch 6/30

Epoch 00006: val_loss did not improve from 0.21698
1470/1470 - 12895s - loss: 0.2047 - accuracy: 0.3312 - categorical_accuracy: 0.3312 - val_loss: 0.2170 - val_accuracy: 0.3073 - val_categorical_accuracy: 0.3073
Epoch 7/30

Epoch 00007: val_loss did not improve from 0.21698
1470/1470 - 13812s - loss: 0.2013 - accuracy: 0.3381 - categorical_accuracy: 0.3381 - val_loss: 0.2182 - val_accuracy: 0.3159 - val_categorical_accuracy: 0.3159
Epoch 8/30

Epoch 00008: val_loss did not improve from 0.21698
1470/1470 - 11023s - loss: 0.1977 - accuracy: 0.3461 - categorical_accuracy: 0.3461 - val_loss: 0.2204 - val_accuracy: 0.3106 - val_categorical_accuracy: 0.3106
Epoch 9/30

Epoch 00009: val_loss did not improve from 0.21698
1470/1470 - 12415s - loss: 0.1939 - accuracy: 0.3546 - categorical_accuracy: 0.3546 - val_loss: 0.2216 - val_accuracy: 0.3052 - val_categorical_accuracy: 0.3052
Epoch 10/30

Epoch 00010: val_loss did not improve from 0.21698
1470/1470 - 9982s - loss: 0.1900 - accuracy: 0.3628 - categorical_accuracy: 0.3628 - val_loss: 0.2245 - val_accuracy: 0.3070 - val_categorical_accuracy: 0.3070
Epoch 11/30

Epoch 00011: val_loss did not improve from 0.21698
1470/1470 - 11391s - loss: 0.1860 - accuracy: 0.3718 - categorical_accuracy: 0.3718 - val_loss: 0.2265 - val_accuracy: 0.3204 - val_categorical_accuracy: 0.3204
Epoch 12/30

Epoch 00012: val_loss did not improve from 0.21698
1470/1470 - 12895s - loss: 0.1819 - accuracy: 0.3802 - categorical_accuracy: 0.3802 - val_loss: 0.2294 - val_accuracy: 0.3012 - val_categorical_accuracy: 0.3012
Epoch 13/30

Epoch 00013: val_loss did not improve from 0.21698
1470/1470 - 12972s - loss: 0.1778 - accuracy: 0.3891 - categorical_accuracy: 0.3891 - val_loss: 0.2340 - val_accuracy: 0.3108 - val_categorical_accuracy: 0.3108
Epoch 14/30

Epoch 00014: val_loss did not improve from 0.21698
1470/1470 - 13357s - loss: 0.1735 - accuracy: 0.3981 - categorical_accuracy: 0.3981 - val_loss: 0.2356 - val_accuracy: 0.3058 - val_categorical_accuracy: 0.3058
Epoch 15/30

Epoch 00015: val_loss did not improve from 0.21698
1470/1470 - 13639s - loss: 0.1694 - accuracy: 0.4066 - categorical_accuracy: 0.4066 - val_loss: 0.2400 - val_accuracy: 0.3001 - val_categorical_accuracy: 0.3001
Epoch 16/30

Epoch 00016: val_loss did not improve from 0.21698
1470/1470 - 12875s - loss: 0.1655 - accuracy: 0.4140 - categorical_accuracy: 0.4140 - val_loss: 0.2449 - val_accuracy: 0.3090 - val_categorical_accuracy: 0.3090
Epoch 17/30

Epoch 00017: val_loss did not improve from 0.21698
1470/1470 - 9629s - loss: 0.1616 - accuracy: 0.4222 - categorical_accuracy: 0.4222 - val_loss: 0.2473 - val_accuracy: 0.3020 - val_categorical_accuracy: 0.3020
Epoch 18/30

Epoch 00018: val_loss did not improve from 0.21698
1470/1470 - 1595s - loss: 0.1575 - accuracy: 0.4301 - categorical_accuracy: 0.4301 - val_loss: 0.2531 - val_accuracy: 0.3006 - val_categorical_accuracy: 0.3006
Epoch 19/30

Epoch 00019: val_loss did not improve from 0.21698
1470/1470 - 1224s - loss: 0.1538 - accuracy: 0.4364 - categorical_accuracy: 0.4364 - val_loss: 0.2602 - val_accuracy: 0.3058 - val_categorical_accuracy: 0.3058
Epoch 20/30

Epoch 00020: val_loss did not improve from 0.21698
1470/1470 - 1221s - loss: 0.1502 - accuracy: 0.4439 - categorical_accuracy: 0.4439 - val_loss: 0.2615 - val_accuracy: 0.2937 - val_categorical_accuracy: 0.2937
Epoch 21/30

Epoch 00021: val_loss did not improve from 0.21698
1470/1470 - 1224s - loss: 0.1465 - accuracy: 0.4504 - categorical_accuracy: 0.4504 - val_loss: 0.2663 - val_accuracy: 0.2922 - val_categorical_accuracy: 0.2922
Epoch 22/30

Epoch 00022: val_loss did not improve from 0.21698
1470/1470 - 1233s - loss: 0.1430 - accuracy: 0.4575 - categorical_accuracy: 0.4575 - val_loss: 0.2719 - val_accuracy: 0.2999 - val_categorical_accuracy: 0.2999
Epoch 23/30

Epoch 00023: val_loss did not improve from 0.21698
1470/1470 - 1223s - loss: 0.1396 - accuracy: 0.4635 - categorical_accuracy: 0.4635 - val_loss: 0.2747 - val_accuracy: 0.2997 - val_categorical_accuracy: 0.2997
Epoch 24/30

Epoch 00024: val_loss did not improve from 0.21698
1470/1470 - 1231s - loss: 0.1363 - accuracy: 0.4691 - categorical_accuracy: 0.4691 - val_loss: 0.2829 - val_accuracy: 0.2964 - val_categorical_accuracy: 0.2964
Epoch 25/30

Epoch 00025: val_loss did not improve from 0.21698
1470/1470 - 1252s - loss: 0.1333 - accuracy: 0.4742 - categorical_accuracy: 0.4742 - val_loss: 0.2855 - val_accuracy: 0.2940 - val_categorical_accuracy: 0.2940
Epoch 26/30

Epoch 00026: val_loss did not improve from 0.21698
1470/1470 - 1234s - loss: 0.1303 - accuracy: 0.4800 - categorical_accuracy: 0.4800 - val_loss: 0.2908 - val_accuracy: 0.2942 - val_categorical_accuracy: 0.2942
Epoch 27/30

Epoch 00027: val_loss did not improve from 0.21698
1470/1470 - 1256s - loss: 0.1272 - accuracy: 0.4855 - categorical_accuracy: 0.4855 - val_loss: 0.2979 - val_accuracy: 0.2956 - val_categorical_accuracy: 0.2956
Epoch 28/30

Epoch 00028: val_loss did not improve from 0.21698
1470/1470 - 1264s - loss: 0.1244 - accuracy: 0.4899 - categorical_accuracy: 0.4899 - val_loss: 0.3004 - val_accuracy: 0.2998 - val_categorical_accuracy: 0.2998
Epoch 29/30

Epoch 00029: val_loss did not improve from 0.21698
1470/1470 - 1251s - loss: 0.1217 - accuracy: 0.4940 - categorical_accuracy: 0.4940 - val_loss: 0.3065 - val_accuracy: 0.2865 - val_categorical_accuracy: 0.2865
Epoch 30/30

Epoch 00030: val_loss did not improve from 0.21698
1470/1470 - 1282s - loss: 0.1190 - accuracy: 0.4978 - categorical_accuracy: 0.4978 - val_loss: 0.3126 - val_accuracy: 0.2933 - val_categorical_accuracy: 0.2933
Time passed: 65.72 hours
11:07:25
