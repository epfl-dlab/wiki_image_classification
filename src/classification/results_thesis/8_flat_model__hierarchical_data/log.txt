{'augment': False, 'oversample': False, 'undersample': False, 'loss_function': 'binary_crossentropy', 'class_weights': False, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 'all', 'hierarchical': False, 'data_folder': 'data/split_hierarchical_data_221218', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 15, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/111_bs_512'}
Time passed: 0.0 hours
01:37:15
Found 773500 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.01 hours
01:37:55
Found 136500 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
01:38:03
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 8,426,017
Non-trainable params: 67,575
_________________________________________________________________
Epoch 1/15

Epoch 00001: val_loss improved from inf to 0.13758, saving model to results_thesis/111_bs_512/cp-0001.ckpt
500/500 - 5739s - loss: 0.1468 - binary_accuracy: 0.9399 - precision: 0.6544 - recall: 0.4320 - pr_auc: 0.2031 - val_loss: 0.1376 - val_binary_accuracy: 0.9435 - val_precision: 0.6869 - val_recall: 0.4644 - val_pr_auc: 0.2518
Epoch 2/15

Epoch 00002: val_loss improved from 0.13758 to 0.13437, saving model to results_thesis/111_bs_512/cp-0002.ckpt
500/500 - 5130s - loss: 0.1347 - binary_accuracy: 0.9446 - precision: 0.6969 - recall: 0.4711 - pr_auc: 0.2628 - val_loss: 0.1344 - val_binary_accuracy: 0.9446 - val_precision: 0.6842 - val_recall: 0.4964 - val_pr_auc: 0.2664
Epoch 3/15

Epoch 00003: val_loss improved from 0.13437 to 0.13326, saving model to results_thesis/111_bs_512/cp-0003.ckpt
500/500 - 3360s - loss: 0.1326 - binary_accuracy: 0.9454 - precision: 0.7033 - recall: 0.4808 - pr_auc: 0.2762 - val_loss: 0.1333 - val_binary_accuracy: 0.9452 - val_precision: 0.6908 - val_recall: 0.4969 - val_pr_auc: 0.2813
Epoch 4/15

Epoch 00004: val_loss improved from 0.13326 to 0.13318, saving model to results_thesis/111_bs_512/cp-0004.ckpt
500/500 - 2361s - loss: 0.1306 - binary_accuracy: 0.9462 - precision: 0.7066 - recall: 0.4906 - pr_auc: 0.2858 - val_loss: 0.1332 - val_binary_accuracy: 0.9449 - val_precision: 0.6943 - val_recall: 0.4851 - val_pr_auc: 0.2855
Epoch 5/15

Epoch 00005: val_loss improved from 0.13318 to 0.13280, saving model to results_thesis/111_bs_512/cp-0005.ckpt
500/500 - 2202s - loss: 0.1295 - binary_accuracy: 0.9465 - precision: 0.7094 - recall: 0.4952 - pr_auc: 0.2989 - val_loss: 0.1328 - val_binary_accuracy: 0.9452 - val_precision: 0.7071 - val_recall: 0.4692 - val_pr_auc: 0.2885
Epoch 6/15

Epoch 00006: val_loss improved from 0.13280 to 0.13199, saving model to results_thesis/111_bs_512/cp-0006.ckpt
500/500 - 1971s - loss: 0.1285 - binary_accuracy: 0.9471 - precision: 0.7136 - recall: 0.4988 - pr_auc: 0.3007 - val_loss: 0.1320 - val_binary_accuracy: 0.9455 - val_precision: 0.6920 - val_recall: 0.5024 - val_pr_auc: 0.2910
Epoch 7/15

Epoch 00007: val_loss did not improve from 0.13199
500/500 - 1657s - loss: 0.1275 - binary_accuracy: 0.9474 - precision: 0.7157 - recall: 0.5047 - pr_auc: 0.3120 - val_loss: 0.1321 - val_binary_accuracy: 0.9455 - val_precision: 0.7073 - val_recall: 0.4750 - val_pr_auc: 0.2942
Epoch 8/15

Epoch 00008: val_loss did not improve from 0.13199
500/500 - 1549s - loss: 0.1269 - binary_accuracy: 0.9476 - precision: 0.7161 - recall: 0.5076 - pr_auc: 0.3189 - val_loss: 0.1324 - val_binary_accuracy: 0.9455 - val_precision: 0.6899 - val_recall: 0.5057 - val_pr_auc: 0.2931
Epoch 9/15

Epoch 00009: val_loss improved from 0.13199 to 0.13142, saving model to results_thesis/111_bs_512/cp-0009.ckpt
500/500 - 1213s - loss: 0.1260 - binary_accuracy: 0.9480 - precision: 0.7194 - recall: 0.5133 - pr_auc: 0.3248 - val_loss: 0.1314 - val_binary_accuracy: 0.9459 - val_precision: 0.7040 - val_recall: 0.4902 - val_pr_auc: 0.2954
Epoch 10/15

Epoch 00010: val_loss did not improve from 0.13142
500/500 - 1273s - loss: 0.1250 - binary_accuracy: 0.9485 - precision: 0.7215 - recall: 0.5185 - pr_auc: 0.3313 - val_loss: 0.1319 - val_binary_accuracy: 0.9458 - val_precision: 0.6987 - val_recall: 0.4980 - val_pr_auc: 0.2981
Epoch 11/15

Epoch 00011: val_loss did not improve from 0.13142
500/500 - 1157s - loss: 0.1238 - binary_accuracy: 0.9490 - precision: 0.7248 - recall: 0.5230 - pr_auc: 0.3387 - val_loss: 0.1327 - val_binary_accuracy: 0.9456 - val_precision: 0.6886 - val_recall: 0.5128 - val_pr_auc: 0.3001
Epoch 12/15

Epoch 00012: val_loss did not improve from 0.13142
500/500 - 1181s - loss: 0.1236 - binary_accuracy: 0.9491 - precision: 0.7246 - recall: 0.5237 - pr_auc: 0.3441 - val_loss: 0.1320 - val_binary_accuracy: 0.9456 - val_precision: 0.7046 - val_recall: 0.4834 - val_pr_auc: 0.2965
Epoch 13/15

Epoch 00013: val_loss did not improve from 0.13142
500/500 - 1223s - loss: 0.1226 - binary_accuracy: 0.9494 - precision: 0.7276 - recall: 0.5289 - pr_auc: 0.3507 - val_loss: 0.1319 - val_binary_accuracy: 0.9458 - val_precision: 0.6989 - val_recall: 0.4968 - val_pr_auc: 0.2990
Epoch 14/15

Epoch 00014: val_loss did not improve from 0.13142
500/500 - 1124s - loss: 0.1215 - binary_accuracy: 0.9499 - precision: 0.7295 - recall: 0.5341 - pr_auc: 0.3541 - val_loss: 0.1328 - val_binary_accuracy: 0.9454 - val_precision: 0.6864 - val_recall: 0.5103 - val_pr_auc: 0.3044
Epoch 15/15

Epoch 00015: val_loss did not improve from 0.13142
500/500 - 1246s - loss: 0.1207 - binary_accuracy: 0.9502 - precision: 0.7316 - recall: 0.5370 - pr_auc: 0.3627 - val_loss: 0.1322 - val_binary_accuracy: 0.9457 - val_precision: 0.6950 - val_recall: 0.5020 - val_pr_auc: 0.3049
Time passed: 9.02 hours
10:39:22
