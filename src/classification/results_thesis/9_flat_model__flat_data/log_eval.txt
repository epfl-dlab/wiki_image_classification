


=============== EVALUATION ====================

Found 390000 validated image filenames belonging to 31 classes.

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 8,426,017
Non-trainable params: 67,575
_________________________________________________________________
results_thesis/112_bs_512/cp-0010.ckpt
Predicting on test set:

762/762 - 7024s
METRICS FOR THRESHOLD 0.5

Mean number of label assignments per image in ground-truth: 1.7681
Mean number of label assignments per image in predictions: 0.9754

                          precision    recall  f1-score   support index
Animals                    0.616487  0.208991  0.312160     823.0     0
Architecture               0.000000  0.000000  0.000000    7877.0     1
Art                        0.690435  0.037918  0.071888   10470.0     2
Belief                     0.000000  0.000000  0.000000       3.0     3
Chemistry                  0.800000  0.028037  0.054176     428.0     4
Culture                    0.537255  0.254254  0.345162   97017.0     5
Diagrams                   0.685714  0.097959  0.171429     980.0     6
Events                     0.535393  0.020427  0.039353   20365.0     7
Food                       0.000000  0.000000  0.000000      34.0     8
Fossils                    0.590106  0.151543  0.241155    1102.0     9
Geology                    0.733333  0.005286  0.010496    2081.0    10
History                    0.615164  0.095888  0.165914   51362.0    11
Landscapes                 0.000000  0.000000  0.000000    1635.0    12
Literature                 1.000000  0.009595  0.019007     938.0    13
Logos & Symbols            0.639885  0.438976  0.520724    1016.0    14
Maps & Flags               0.780265  0.629445  0.696787    5427.0    15
Mathematics                0.888889  0.086022  0.156863      93.0    16
Medicine & Health          0.111111  0.025404  0.041353     433.0    17
Monuments & Memorials      0.000000  0.000000  0.000000     663.0    18
Music                      0.333333  0.004983  0.009820    2408.0    19
Nature                     0.688348  0.362026  0.474497   53963.0    20
People                     0.624424  0.621355  0.622886   86865.0    21
Places                     0.693548  0.641250  0.666374  142227.0    22
Plants                     0.537797  0.464227  0.498311    4291.0    23
Politics                   0.576835  0.084975  0.148130   20806.0    24
STEM                       0.000000  0.000000  0.000000       1.0    25
Society                    0.591595  0.186428  0.283513  121500.0    26
Space                      1.000000  0.001770  0.003534     565.0    27
Sports                     0.679860  0.471585  0.556886   23966.0    28
Technology & Engineering   0.596258  0.269346  0.371070   21296.0    29
Transportation             0.596671  0.104508  0.177863    8918.0    30
micro avg                  0.641035  0.353649  0.455826  689553.0  None
macro avg                  0.520733  0.171039  0.214818  689553.0  None
weighted avg               0.614018  0.353649  0.414290  689553.0  None
samples avg                0.526601  0.410120  0.434350  689553.0  None
Ordered class in descending order of samples:
 ['Places' 'Society' 'Culture' 'People' 'Nature' 'History' 'Sports'
 'Technology & Engineering' 'Politics' 'Events' 'Art' 'Transportation'
 'Architecture' 'Maps & Flags' 'Plants' 'Music' 'Geology' 'Landscapes'
 'Fossils' 'Logos & Symbols' 'Diagrams' 'Literature' 'Animals'
 'Monuments & Memorials' 'Space' 'Medicine & Health' 'Chemistry'
 'Mathematics' 'Food' 'Belief' 'STEM']

Unweighted avg. F1-score of all classes: 0.21481778128691015
Unweighted avg. F1-score of top 5 classes: 0.4784865376746028
Unweighted avg. F1-score of the rest: 0.16411225121235384


Unweighted avg. precision of all classes: 0.5207325199951724
Unweighted avg. precision of top 5 classes: 0.627034237979887
Unweighted avg. precision of the rest: 0.5002898819211888


Unweighted avg. recall of all classes: 0.17103870409823727
Unweighted avg. recall of top 5 classes: 0.41306255059205876
Unweighted avg. recall of the rest: 0.12449565669557927



-------------------------- PR AUC metrics table -----------------------
Macro PR_AUC is: 0.2713528574042624
                  label_name    pr_auc  random_auc  better_than_random
0                    Animals  0.326112    0.002110             154.537
1               Architecture  0.101798    0.020197               5.040
2                        Art  0.207083    0.026846               7.714
3                     Belief  0.000232    0.000008              30.168
4                  Chemistry  0.080950    0.001097              73.763
5                    Culture  0.469899    0.248762               1.889
6                   Diagrams  0.262334    0.002513             104.398
7                     Events  0.216225    0.052218               4.141
8                       Food  0.006243    0.000087              71.616
9                    Fossils  0.297174    0.002826             105.170
10                   Geology  0.092553    0.005336              17.345
11                   History  0.351816    0.131697               2.671
12                Landscapes  0.047531    0.004192              11.338
13                Literature  0.046161    0.002405              19.193
14           Logos & Symbols  0.512546    0.002605             196.745
15              Maps & Flags  0.723035    0.013915              51.959
16               Mathematics  0.122098    0.000238             512.022
17         Medicine & Health  0.013705    0.001110              12.344
18     Monuments & Memorials  0.027709    0.001700              16.299
19                     Music  0.087460    0.006174              14.165
20                    Nature  0.544447    0.138367               3.935
21                    People  0.638075    0.222731               2.865
22                    Places  0.737920    0.364685               2.023
23                    Plants  0.493601    0.011003              44.862
24                  Politics  0.282817    0.053349               5.301
25                      STEM  0.000005    0.000003               1.895
26                   Society  0.500812    0.311538               1.608
27                     Space  0.023943    0.001449              16.527
28                    Sports  0.559336    0.061451               9.102
29  Technology & Engineering  0.397143    0.054605               7.273
30            Transportation  0.241174    0.022867              10.547


----------------------Sorted by the best PR_AUC-------------------
                  label_name    pr_auc  random_auc  better_than_random
22                    Places  0.737920    0.364685               2.023
15              Maps & Flags  0.723035    0.013915              51.959
21                    People  0.638075    0.222731               2.865
28                    Sports  0.559336    0.061451               9.102
20                    Nature  0.544447    0.138367               3.935
14           Logos & Symbols  0.512546    0.002605             196.745
26                   Society  0.500812    0.311538               1.608
23                    Plants  0.493601    0.011003              44.862
5                    Culture  0.469899    0.248762               1.889
29  Technology & Engineering  0.397143    0.054605               7.273
11                   History  0.351816    0.131697               2.671
0                    Animals  0.326112    0.002110             154.537
9                    Fossils  0.297174    0.002826             105.170
24                  Politics  0.282817    0.053349               5.301
6                   Diagrams  0.262334    0.002513             104.398
30            Transportation  0.241174    0.022867              10.547
7                     Events  0.216225    0.052218               4.141
2                        Art  0.207083    0.026846               7.714
16               Mathematics  0.122098    0.000238             512.022
1               Architecture  0.101798    0.020197               5.040
10                   Geology  0.092553    0.005336              17.345
19                     Music  0.087460    0.006174              14.165
4                  Chemistry  0.080950    0.001097              73.763
12                Landscapes  0.047531    0.004192              11.338
13                Literature  0.046161    0.002405              19.193
18     Monuments & Memorials  0.027709    0.001700              16.299
27                     Space  0.023943    0.001449              16.527
17         Medicine & Health  0.013705    0.001110              12.344
8                       Food  0.006243    0.000087              71.616
3                     Belief  0.000232    0.000008              30.168
25                      STEM  0.000005    0.000003               1.895


----------------------Sorted by the best compared to random-------------------
                  label_name    pr_auc  random_auc  better_than_random
16               Mathematics  0.122098    0.000238             512.022
14           Logos & Symbols  0.512546    0.002605             196.745
0                    Animals  0.326112    0.002110             154.537
9                    Fossils  0.297174    0.002826             105.170
6                   Diagrams  0.262334    0.002513             104.398
4                  Chemistry  0.080950    0.001097              73.763
8                       Food  0.006243    0.000087              71.616
15              Maps & Flags  0.723035    0.013915              51.959
23                    Plants  0.493601    0.011003              44.862
3                     Belief  0.000232    0.000008              30.168
13                Literature  0.046161    0.002405              19.193
10                   Geology  0.092553    0.005336              17.345
27                     Space  0.023943    0.001449              16.527
18     Monuments & Memorials  0.027709    0.001700              16.299
19                     Music  0.087460    0.006174              14.165
17         Medicine & Health  0.013705    0.001110              12.344
12                Landscapes  0.047531    0.004192              11.338
30            Transportation  0.241174    0.022867              10.547
28                    Sports  0.559336    0.061451               9.102
2                        Art  0.207083    0.026846               7.714
29  Technology & Engineering  0.397143    0.054605               7.273
24                  Politics  0.282817    0.053349               5.301
1               Architecture  0.101798    0.020197               5.040
7                     Events  0.216225    0.052218               4.141
20                    Nature  0.544447    0.138367               3.935
21                    People  0.638075    0.222731               2.865
11                   History  0.351816    0.131697               2.671
22                    Places  0.737920    0.364685               2.023
25                      STEM  0.000005    0.000003               1.895
5                    Culture  0.469899    0.248762               1.889
26                   Society  0.500812    0.311538               1.608
