Found 50000 validated image filenames belonging to 31 classes.

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 8,426,017
Non-trainable params: 67,575
_________________________________________________________________
results_thesis/108_bs_512/checkpoints/cp-0005.ckpt
Predicting on test set:

98/98 - 799s
Found 50000 validated image filenames belonging to 31 classes.
Predicting on validation set:

98/98 - 87s
METRICS FOR THRESHOLD 0.5

Mean number of label assignments per image in ground-truth: 2.3975
Mean number of label assignments per image in predictions: 1.6541

                          precision    recall  f1-score   support index
Animals                    0.615385  0.200000  0.301887     120.0     0
Architecture               1.000000  0.001009  0.002016     991.0     1
Art                        0.651163  0.041854  0.078652    1338.0     2
Belief                     0.000000  0.000000  0.000000       2.0     3
Biology                    0.888889  0.250784  0.391198     319.0     4
Chemistry                  0.600000  0.056604  0.103448      53.0     5
Culture                    0.626069  0.369846  0.464998   17026.0     6
Earth & Environment        0.000000  0.000000  0.000000      26.0     7
Entertainment              0.683871  0.059152  0.108885    1792.0     8
Events                     0.719512  0.022684  0.043981    2601.0     9
Food                       0.000000  0.000000  0.000000       4.0    10
Fossils                    0.509091  0.201439  0.288660     139.0    11
History                    0.674877  0.081294  0.145108    6741.0    12
Landscapes                 0.000000  0.000000  0.000000     190.0    13
Literature                 0.500000  0.008621  0.016949     116.0    14
Maps & Flags               0.798646  0.643052  0.712453     734.0    15
Mathematics                0.500000  0.058824  0.105263      17.0    16
Medicine & Health          0.000000  0.000000  0.000000    1798.0    17
Music                      0.454545  0.015773  0.030488     317.0    18
Nature                     0.736089  0.450201  0.558697    7199.0    19
People                     0.613642  0.531932  0.569873   10131.0    20
Physics                    0.000000  0.000000  0.000000     111.0    21
Places                     0.698117  0.717115  0.707489   19439.0    22
Plants                     0.727273  0.056940  0.105611     562.0    23
Politics                   0.584416  0.101848  0.173466    2651.0    24
STEM                       0.727517  0.372141  0.492406   11630.0    25
Society                    0.743068  0.756387  0.749668   26891.0    26
Space                      0.000000  0.000000  0.000000      59.0    27
Sports                     0.646745  0.560726  0.600672    3030.0    28
Technology & Engineering   0.714136  0.249451  0.369748    2734.0    29
Transportation             0.660000  0.088949  0.156770    1113.0    30
micro avg                  0.697689  0.481347  0.569670  119874.0  None
macro avg                  0.518485  0.190214  0.234787  119874.0  None
weighted avg               0.680372  0.481347  0.525668  119874.0  None
samples avg                0.691737  0.550544  0.573461  119874.0  None

Unweighted avg. F1-score of all classes: 0.23478655505343754
Unweighted avg. F1-score of top 5 classes: 0.5540562739919729
Unweighted avg. F1-score of the rest: 0.17338853218064226


Unweighted avg. precision of all classes: 0.5184854961106827
Unweighted avg. precision of top 5 classes: 0.6861206475378505
Unweighted avg. precision of the rest: 0.4862479669900735


Unweighted avg. recall of all classes: 0.19021364559591103
Unweighted avg. recall of top 5 classes: 0.5354559633808593
Unweighted avg. recall of the rest: 0.12382089217572867

METRICS WHEN HAVING PER-CLASS THRESHOLDS

Mean number of label assignments per image in ground-truth: 2.3975
Mean number of label assignments per image in predictions: 6.1427

                          precision    recall  f1-score   support index
Animals                    0.462366  0.358333  0.403756     120.0     0
Architecture               0.111047  0.390515  0.172922     991.0     1
Art                        0.229920  0.342302  0.275075    1338.0     2
Belief                     0.000040  1.000000  0.000080       2.0     3
Biology                    0.695364  0.329154  0.446809     319.0     4
Chemistry                  0.428571  0.056604  0.100000      53.0     5
Culture                    0.481946  0.740045  0.583739   17026.0     6
Earth & Environment        0.000520  1.000000  0.001039      26.0     7
Entertainment              0.267509  0.260045  0.263724    1792.0     8
Events                     0.234313  0.389081  0.292486    2601.0     9
Food                       0.010000  0.250000  0.019231       4.0    10
Fossils                    0.348148  0.338129  0.343066     139.0    11
History                    0.288193  0.527221  0.372673    6741.0    12
Landscapes                 0.072368  0.347368  0.119782     190.0    13
Literature                 0.092920  0.181034  0.122807     116.0    14
Maps & Flags               0.760417  0.696185  0.726885     734.0    15
Mathematics                0.000340  1.000000  0.000680      17.0    16
Medicine & Health          0.132433  0.512792  0.210502    1798.0    17
Music                      0.185965  0.167192  0.176080     317.0    18
Nature                     0.629064  0.526740  0.573373    7199.0    19
People                     0.550032  0.689073  0.611751   10131.0    20
Physics                    0.063291  0.090090  0.074349     111.0    21
Places                     0.650275  0.826534  0.727886   19439.0    22
Plants                     0.535232  0.635231  0.580960     562.0    23
Politics                   0.333455  0.345530  0.339385    2651.0    24
STEM                       0.560923  0.510232  0.534378   11630.0    25
Society                    0.688582  0.853334  0.762156   26891.0    26
Space                      0.080808  0.135593  0.101266      59.0    27
Sports                     0.594941  0.628713  0.611361    3030.0    28
Technology & Engineering   0.495996  0.385150  0.433601    2734.0    29
Transportation             0.286171  0.321653  0.302876    1113.0    30
micro avg                  0.262496  0.672556  0.377612  119874.0  None
macro avg                  0.331327  0.478512  0.331764  119874.0  None
weighted avg               0.545062  0.672556  0.594564  119874.0  None
samples avg                0.259540  0.729660  0.364503  119874.0  None

Unweighted avg. F1-score of all classes: 0.33176380581873266
Unweighted avg. F1-score of top 5 classes: 0.5657357400332514
Unweighted avg. F1-score of the rest: 0.2867692030851713


Unweighted avg. precision of all classes: 0.3313274719080116
Unweighted avg. precision of top 5 classes: 0.5589276530238141
Unweighted avg. precision of the rest: 0.2875582063088189


Unweighted avg. recall of all classes: 0.47851210186864784
Unweighted avg. recall of top 5 classes: 0.7706667658324347
Unweighted avg. recall of the rest: 0.4223285126448427



-------------------------- PR AUC metrics table -----------------------
Macro PR_AUC is: 0.31025179403738595
                  label_name    pr_auc  random_auc  better_than_random
0                    Animals  0.357797     0.00240             149.082
1               Architecture  0.106676     0.01982               5.382
2                        Art  0.211617     0.02676               7.908
3                     Belief  0.000054     0.00004               1.347
4                    Biology  0.392738     0.00638              61.558
5                  Chemistry  0.074082     0.00106              69.889
6                    Culture  0.598156     0.34052               1.757
7        Earth & Environment  0.002786     0.00052               5.357
8              Entertainment  0.228357     0.03584               6.372
9                     Events  0.229556     0.05202               4.413
10                      Food  0.002158     0.00008              26.981
11                   Fossils  0.280535     0.00278             100.912
12                   History  0.351646     0.13482               2.608
13                Landscapes  0.066567     0.00380              17.518
14                Literature  0.049781     0.00232              21.457
15              Maps & Flags  0.719657     0.01468              49.023
16               Mathematics  0.109308     0.00034             321.495
17         Medicine & Health  0.136183     0.03596               3.787
18                     Music  0.107634     0.00634              16.977
19                    Nature  0.621304     0.14398               4.315
20                    People  0.599319     0.20262               2.958
21                   Physics  0.020092     0.00222               9.050
22                    Places  0.768916     0.38878               1.978
23                    Plants  0.548659     0.01124              48.813
24                  Politics  0.290783     0.05302               5.484
25                      STEM  0.603853     0.23260               2.596
26                   Society  0.835123     0.53782               1.553
27                     Space  0.026313     0.00118              22.299
28                    Sports  0.586513     0.06060               9.678
29  Technology & Engineering  0.433418     0.05468               7.926
30            Transportation  0.258225     0.02226              11.600


----------------------Sorted by the best PR_AUC-------------------
                  label_name    pr_auc  random_auc  better_than_random
26                   Society  0.835123     0.53782               1.553
22                    Places  0.768916     0.38878               1.978
15              Maps & Flags  0.719657     0.01468              49.023
19                    Nature  0.621304     0.14398               4.315
25                      STEM  0.603853     0.23260               2.596
20                    People  0.599319     0.20262               2.958
6                    Culture  0.598156     0.34052               1.757
28                    Sports  0.586513     0.06060               9.678
23                    Plants  0.548659     0.01124              48.813
29  Technology & Engineering  0.433418     0.05468               7.926
4                    Biology  0.392738     0.00638              61.558
0                    Animals  0.357797     0.00240             149.082
12                   History  0.351646     0.13482               2.608
24                  Politics  0.290783     0.05302               5.484
11                   Fossils  0.280535     0.00278             100.912
30            Transportation  0.258225     0.02226              11.600
9                     Events  0.229556     0.05202               4.413
8              Entertainment  0.228357     0.03584               6.372
2                        Art  0.211617     0.02676               7.908
17         Medicine & Health  0.136183     0.03596               3.787
16               Mathematics  0.109308     0.00034             321.495
18                     Music  0.107634     0.00634              16.977
1               Architecture  0.106676     0.01982               5.382
5                  Chemistry  0.074082     0.00106              69.889
13                Landscapes  0.066567     0.00380              17.518
14                Literature  0.049781     0.00232              21.457
27                     Space  0.026313     0.00118              22.299
21                   Physics  0.020092     0.00222               9.050
7        Earth & Environment  0.002786     0.00052               5.357
10                      Food  0.002158     0.00008              26.981
3                     Belief  0.000054     0.00004               1.347


----------------------Sorted by the best compared to random-------------------
                  label_name    pr_auc  random_auc  better_than_random
16               Mathematics  0.109308     0.00034             321.495
0                    Animals  0.357797     0.00240             149.082
11                   Fossils  0.280535     0.00278             100.912
5                  Chemistry  0.074082     0.00106              69.889
4                    Biology  0.392738     0.00638              61.558
15              Maps & Flags  0.719657     0.01468              49.023
23                    Plants  0.548659     0.01124              48.813
10                      Food  0.002158     0.00008              26.981
27                     Space  0.026313     0.00118              22.299
14                Literature  0.049781     0.00232              21.457
13                Landscapes  0.066567     0.00380              17.518
18                     Music  0.107634     0.00634              16.977
30            Transportation  0.258225     0.02226              11.600
28                    Sports  0.586513     0.06060               9.678
21                   Physics  0.020092     0.00222               9.050
29  Technology & Engineering  0.433418     0.05468               7.926
2                        Art  0.211617     0.02676               7.908
8              Entertainment  0.228357     0.03584               6.372
24                  Politics  0.290783     0.05302               5.484
1               Architecture  0.106676     0.01982               5.382
7        Earth & Environment  0.002786     0.00052               5.357
9                     Events  0.229556     0.05202               4.413
19                    Nature  0.621304     0.14398               4.315
17         Medicine & Health  0.136183     0.03596               3.787
20                    People  0.599319     0.20262               2.958
12                   History  0.351646     0.13482               2.608
25                      STEM  0.603853     0.23260               2.596
22                    Places  0.768916     0.38878               1.978
6                    Culture  0.598156     0.34052               1.757
26                   Society  0.835123     0.53782               1.553
3                     Belief  0.000054     0.00004               1.347
2 Physical GPUs, 1 Logical GPU
