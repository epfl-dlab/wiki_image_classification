{'augment': False, 'oversample': False, 'undersample': False, 'loss_function': 'binary_crossentropy', 'class_weights': False, 'per_class_thresh': False, 'random_initialization': False, 'number_trainable_layers': 'all', 'hierarchical': False, 'data_folder': 'data/split_hierarchical_data_221129', 'batch_size': 512, 'basemodel': 'EfficientNetB2', 'epochs': 20, 'nr_classes': 'all', 'image_dimension': 64, 'results_folder': 'results_thesis/108_bs_512'}
Time passed: 0.0 hours
22:53:34
Found 760000 validated image filenames belonging to 31 classes.
LOG: finished getting the first flow
Time passed: 0.02 hours
22:54:45
Found 50000 validated image filenames belonging to 31 classes.
LOG: Got the validation flow
Time passed: 0.0 hours
22:54:48
LOG: creating and training model

Number of layers in basemodel: 339
Number of trainable layers: 339

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb2 (Functional)  (None, 2, 2, 1408)        7768569   
_________________________________________________________________
flatten (Flatten)            (None, 5632)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               721024    
_________________________________________________________________
dense_1 (Dense)              (None, 31)                3999      
=================================================================
Total params: 8,493,592
Trainable params: 8,426,017
Non-trainable params: 67,575
_________________________________________________________________
Epoch 1/20

Epoch 00001: val_loss improved from inf to 0.14279, saving model to results_thesis/108_bs_512/cp-0001.ckpt
1485/1485 - 11507s - loss: 0.1487 - binary_accuracy: 0.9400 - precision: 0.6777 - recall: 0.4307 - pr_auc: 0.2352 - roc_auc: 0.7200 - fn: 1040376.0000 - fp: 374218.0000 - tn: 21358368.0000 - tp: 787036.0000 - val_loss: 0.1428 - val_binary_accuracy: 0.9422 - val_precision: 0.6830 - val_recall: 0.4703 - val_pr_auc: 0.2746 - val_roc_auc: 0.7412 - val_fn: 63494.0000 - val_fp: 26167.0000 - val_tn: 1403959.0000 - val_tp: 56380.0000
Epoch 2/20

Epoch 00002: val_loss improved from 0.14279 to 0.14037, saving model to results_thesis/108_bs_512/cp-0002.ckpt
1485/1485 - 11463s - loss: 0.1404 - binary_accuracy: 0.9432 - precision: 0.7034 - recall: 0.4622 - pr_auc: 0.2863 - roc_auc: 0.7543 - fn: 982835.0000 - fp: 356155.0000 - tn: 21376460.0000 - tp: 844577.0000 - val_loss: 0.1404 - val_binary_accuracy: 0.9434 - val_precision: 0.6909 - val_recall: 0.4843 - val_pr_auc: 0.2911 - val_roc_auc: 0.7538 - val_fn: 61815.0000 - val_fp: 25974.0000 - val_tn: 1404152.0000 - val_tp: 58059.0000
Epoch 3/20

Epoch 00003: val_loss improved from 0.14037 to 0.13996, saving model to results_thesis/108_bs_512/cp-0003.ckpt
1485/1485 - 11715s - loss: 0.1376 - binary_accuracy: 0.9443 - precision: 0.7106 - recall: 0.4747 - pr_auc: 0.3062 - roc_auc: 0.7641 - fn: 959914.0000 - fp: 353240.0000 - tn: 21379352.0000 - tp: 867498.0000 - val_loss: 0.1400 - val_binary_accuracy: 0.9436 - val_precision: 0.7054 - val_recall: 0.4650 - val_pr_auc: 0.2973 - val_roc_auc: 0.7503 - val_fn: 64131.0000 - val_fp: 23275.0000 - val_tn: 1406851.0000 - val_tp: 55743.0000
Epoch 4/20

Epoch 00004: val_loss improved from 0.13996 to 0.13973, saving model to results_thesis/108_bs_512/cp-0004.ckpt
1485/1485 - 2867s - loss: 0.1353 - binary_accuracy: 0.9452 - precision: 0.7158 - recall: 0.4859 - pr_auc: 0.3240 - roc_auc: 0.7725 - fn: 939522.0000 - fp: 352536.0000 - tn: 21380056.0000 - tp: 887890.0000 - val_loss: 0.1397 - val_binary_accuracy: 0.9436 - val_precision: 0.6993 - val_recall: 0.4746 - val_pr_auc: 0.3000 - val_roc_auc: 0.7581 - val_fn: 62976.0000 - val_fp: 24468.0000 - val_tn: 1405658.0000 - val_tp: 56898.0000
Epoch 5/20

Epoch 00005: val_loss improved from 0.13973 to 0.13905, saving model to results_thesis/108_bs_512/cp-0005.ckpt
1485/1485 - 1416s - loss: 0.1330 - binary_accuracy: 0.9460 - precision: 0.7211 - recall: 0.4959 - pr_auc: 0.3367 - roc_auc: 0.7823 - fn: 921193.0000 - fp: 350583.0000 - tn: 21382008.0000 - tp: 906219.0000 - val_loss: 0.1390 - val_binary_accuracy: 0.9438 - val_precision: 0.6977 - val_recall: 0.4813 - val_pr_auc: 0.3053 - val_roc_auc: 0.7669 - val_fn: 62173.0000 - val_fp: 25002.0000 - val_tn: 1405124.0000 - val_tp: 57701.0000
Epoch 6/20

Epoch 00006: val_loss did not improve from 0.13905
1485/1485 - 1412s - loss: 0.1307 - binary_accuracy: 0.9469 - precision: 0.7264 - recall: 0.5063 - pr_auc: 0.3518 - roc_auc: 0.7898 - fn: 902282.0000 - fp: 348400.0000 - tn: 21384192.0000 - tp: 925130.0000 - val_loss: 0.1409 - val_binary_accuracy: 0.9433 - val_precision: 0.6863 - val_recall: 0.4905 - val_pr_auc: 0.3011 - val_roc_auc: 0.7558 - val_fn: 61075.0000 - val_fp: 26871.0000 - val_tn: 1403255.0000 - val_tp: 58799.0000
Epoch 7/20

Epoch 00007: val_loss did not improve from 0.13905
1485/1485 - 1412s - loss: 0.1283 - binary_accuracy: 0.9479 - precision: 0.7320 - recall: 0.5179 - pr_auc: 0.3671 - roc_auc: 0.7999 - fn: 881038.0000 - fp: 346545.0000 - tn: 21386032.0000 - tp: 946374.0000 - val_loss: 0.1414 - val_binary_accuracy: 0.9429 - val_precision: 0.6940 - val_recall: 0.4685 - val_pr_auc: 0.3015 - val_roc_auc: 0.7613 - val_fn: 63709.0000 - val_fp: 24759.0000 - val_tn: 1405367.0000 - val_tp: 56165.0000
Epoch 8/20

Epoch 00008: val_loss did not improve from 0.13905
1485/1485 - 1412s - loss: 0.1257 - binary_accuracy: 0.9489 - precision: 0.7377 - recall: 0.5294 - pr_auc: 0.3836 - roc_auc: 0.8085 - fn: 860007.0000 - fp: 344031.0000 - tn: 21388566.0000 - tp: 967405.0000 - val_loss: 0.1424 - val_binary_accuracy: 0.9427 - val_precision: 0.6765 - val_recall: 0.4961 - val_pr_auc: 0.2987 - val_roc_auc: 0.7556 - val_fn: 60404.0000 - val_fp: 28444.0000 - val_tn: 1401682.0000 - val_tp: 59470.0000
Epoch 9/20

Epoch 00009: val_loss did not improve from 0.13905
1485/1485 - 1414s - loss: 0.1230 - binary_accuracy: 0.9500 - precision: 0.7436 - recall: 0.5419 - pr_auc: 0.3984 - roc_auc: 0.8195 - fn: 837176.0000 - fp: 341438.0000 - tn: 21391140.0000 - tp: 990236.0000 - val_loss: 0.1436 - val_binary_accuracy: 0.9422 - val_precision: 0.6762 - val_recall: 0.4860 - val_pr_auc: 0.2942 - val_roc_auc: 0.7523 - val_fn: 61613.0000 - val_fp: 27904.0000 - val_tn: 1402222.0000 - val_tp: 58261.0000
Epoch 10/20

Epoch 00010: val_loss did not improve from 0.13905
1485/1485 - 1416s - loss: 0.1201 - binary_accuracy: 0.9511 - precision: 0.7497 - recall: 0.5548 - pr_auc: 0.4141 - roc_auc: 0.8300 - fn: 813552.0000 - fp: 338502.0000 - tn: 21394086.0000 - tp: 1013860.0000 - val_loss: 0.1455 - val_binary_accuracy: 0.9422 - val_precision: 0.6732 - val_recall: 0.4903 - val_pr_auc: 0.2918 - val_roc_auc: 0.7428 - val_fn: 61098.0000 - val_fp: 28528.0000 - val_tn: 1401598.0000 - val_tp: 58776.0000
Epoch 11/20

Epoch 00011: val_loss did not improve from 0.13905
1485/1485 - 1416s - loss: 0.1172 - binary_accuracy: 0.9523 - precision: 0.7557 - recall: 0.5682 - pr_auc: 0.4301 - roc_auc: 0.8361 - fn: 789059.0000 - fp: 335750.0000 - tn: 21396852.0000 - tp: 1038353.0000 - val_loss: 0.1482 - val_binary_accuracy: 0.9418 - val_precision: 0.6673 - val_recall: 0.4923 - val_pr_auc: 0.2964 - val_roc_auc: 0.7469 - val_fn: 60855.0000 - val_fp: 29421.0000 - val_tn: 1400705.0000 - val_tp: 59019.0000
Epoch 12/20

Epoch 00012: val_loss did not improve from 0.13905
1485/1485 - 1864s - loss: 0.1142 - binary_accuracy: 0.9534 - precision: 0.7615 - recall: 0.5816 - pr_auc: 0.4469 - roc_auc: 0.8463 - fn: 764518.0000 - fp: 332916.0000 - tn: 21399680.0000 - tp: 1062894.0000 - val_loss: 0.1501 - val_binary_accuracy: 0.9404 - val_precision: 0.6502 - val_recall: 0.4967 - val_pr_auc: 0.2918 - val_roc_auc: 0.7415 - val_fn: 60328.0000 - val_fp: 32033.0000 - val_tn: 1398093.0000 - val_tp: 59546.0000
Epoch 13/20

Epoch 00013: val_loss did not improve from 0.13905
1485/1485 - 6439s - loss: 0.1112 - binary_accuracy: 0.9546 - precision: 0.7671 - recall: 0.5952 - pr_auc: 0.4676 - roc_auc: 0.8560 - fn: 739738.0000 - fp: 330274.0000 - tn: 21402312.0000 - tp: 1087674.0000 - val_loss: 0.1533 - val_binary_accuracy: 0.9399 - val_precision: 0.6439 - val_recall: 0.4989 - val_pr_auc: 0.2890 - val_roc_auc: 0.7389 - val_fn: 60066.0000 - val_fp: 33082.0000 - val_tn: 1397044.0000 - val_tp: 59808.0000
Epoch 14/20

Epoch 00014: val_loss did not improve from 0.13905
1485/1485 - 12183s - loss: 0.1084 - binary_accuracy: 0.9557 - precision: 0.7729 - recall: 0.6078 - pr_auc: 0.4785 - roc_auc: 0.8615 - fn: 716768.0000 - fp: 326377.0000 - tn: 21406228.0000 - tp: 1110644.0000 - val_loss: 0.1560 - val_binary_accuracy: 0.9397 - val_precision: 0.6378 - val_recall: 0.5105 - val_pr_auc: 0.2814 - val_roc_auc: 0.7339 - val_fn: 58679.0000 - val_fp: 34746.0000 - val_tn: 1395380.0000 - val_tp: 61195.0000
Epoch 15/20

Epoch 00015: val_loss did not improve from 0.13905
1485/1485 - 12424s - loss: 0.1053 - binary_accuracy: 0.9569 - precision: 0.7789 - recall: 0.6212 - pr_auc: 0.4953 - roc_auc: 0.8709 - fn: 692233.0000 - fp: 322191.0000 - tn: 21410394.0000 - tp: 1135179.0000 - val_loss: 0.1585 - val_binary_accuracy: 0.9394 - val_precision: 0.6384 - val_recall: 0.4983 - val_pr_auc: 0.2823 - val_roc_auc: 0.7322 - val_fn: 60135.0000 - val_fp: 33840.0000 - val_tn: 1396286.0000 - val_tp: 59739.0000
Epoch 16/20
